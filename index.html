<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SafeMind-اپلیکیشن جامع  </title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;700;800&display=swap');

        body {
            font-family: 'Vazirmatn', sans-serif;
            background-color: #f0f2f5; 
            color: #1f2937; 
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: flex-start; 
            min-height: 100vh;
            padding: 20px 0; 
            box-sizing: border-box;
        }

        body.dark {
            background-color: #111827; 
            color: #d1d5db; 
        }

        .app-container {
            max-width: 600px; 
            width: 100%;
            margin-left: auto;
            margin-right: auto;
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            overflow: hidden; 
            display: flex;
            flex-direction: column;
            min-height: calc(100vh - 40px); 
            max-height: calc(100vh - 40px); 
        }

        body.dark .app-container {
            background-color: #1f2937; 
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .app-bar {
            background-color: #2563eb; 
            color: white;
            padding: 1rem; 
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0; 
        }

        body.dark .app-bar {
            background-color: #374151; 
        }

        .content-area {
            flex-grow: 1;
            padding: 1.5rem; 
            overflow-y: auto; 
            -webkit-overflow-scrolling: touch; 
        }

        .clean-days-box {
            background-color: #eff6ff; 
            border: 2px solid #3b82f6; 
        }

        body.dark .clean-days-box {
            background-color: #374151; 
            border: 2px solid #60a5fa; 
        }

        .check-in-button {
            background-color: #2563eb;
        }

        .check-in-button:hover {
            background-color: #1d4ed8;
        }

        .check-in-button:disabled {
            background-color: #a7f3d0; 
            cursor: not-allowed;
            color: #065f46; 
        }

        .card {
            background-color: #f9fafb; 
            border: 1px solid #e5e7eb; 
        }

        body.dark .card {
            background-color: #374151; 
            border: 1px solid #4b5563; 
        }

        .sidebar {
            position: fixed;
            top: 0;
            right: -280px; 
            width: 280px;
            height: 100%;
            background-color: #ffffff;
            box-shadow: -4px 0 20px rgba(0, 0, 0, 0.1);
            transition: right 0.3s ease-in-out;
            z-index: 1500;
            display: flex;
            flex-direction: column;
            padding-top: 1rem;
            overflow-y: auto;
        }

        .sidebar.open {
            right: 0; 
        }

        body.dark .sidebar {
            background-color: #1f2937;
            box-shadow: -4px 0 20px rgba(0, 0, 0, 0.3);
        }

        .sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1400;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
        }

        .sidebar-overlay.open {
            opacity: 1;
            visibility: visible;
        }

        .sidebar-button {
            display: flex;
            align-items: center;
            padding: 0.9rem 1.25rem; 
            width: 100%;
            text-align: right;
            color: #1f2937; 
            font-size: 1rem; 
            font-weight: 500;
            transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out;
            border-bottom: 1px solid #f3f4f6; 
        }

        body.dark .sidebar-button {
            color: #d1d5db; 
            border-bottom: 1px solid #374151; 
        }

        .sidebar-button:hover {
            background-color: #f3f4f6; 
            color: #2563eb; 
        }
         body.dark .sidebar-button:hover {
            background-color: #374151;
            color: #60a5fa;
        }


        .sidebar-button.active {
            background-color: #dbeafe; 
            color: #1e40af; 
            font-weight: 700; 
        }

        body.dark .sidebar-button.active {
            background-color: #3b82f6; 
            color: #ffffff;
        }

        .sidebar-button i {
            margin-left: 1rem; 
            font-size: 1.2rem; 
        }

        .snackbar {
            position: fixed;
            bottom: 20px; 
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(17, 24, 39, 0.85); 
            color: white;
            padding: 0.75rem 1.25rem;
            border-radius: 8px;
            opacity: 0;
            transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
            z-index: 2000; 
            min-width: 250px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        .snackbar.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }
         .snackbar.hide { 
            opacity: 0;
            transform: translateX(-50%) translateY(20px);
        }

        .splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #2563eb;
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 4000; 
            opacity: 1;
            transition: opacity 1s ease-out;
        }
        .splash-screen.fade-out {
            opacity: 0;
            visibility: hidden;
        }
        body.dark .splash-screen {
            background-color: #111827;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2500;
            padding: 1rem;
        }

        .modal-content {
            background-color: #ffffff;
            padding: 1.5rem 2rem; 
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            text-align: center;
            max-width: 400px;
            width: calc(100% - 2rem); 
        }
        body.dark .modal-content {
            background-color: #1f2937; 
        }

        /* Memory Game Specific Styles */
        .memory-game-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            max-width: 400px; /* Adjust as needed */
            margin: 20px auto;
        }

        .memory-card {
            width: 80px; /* Card size */
            height: 80px;
            background-color: #3b82f6; /* Blue card back */
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            cursor: pointer;
            transform-style: preserve-3d;
            transition: transform 0.6s;
            position: relative;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .memory-card.flipped {
            transform: rotateY(180deg);
        }
        
        .memory-card.matched {
            opacity: 0.5;
            pointer-events: none;
        }

        .memory-card .card-face, .memory-card .card-back {
            position: absolute;
            backface-visibility: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
        }

        .memory-card .card-face {
            background-color: #dbeafe; /* Light blue card front */
            color: #1e40af; /* Dark blue text */
            transform: rotateY(180deg);
        }

        .memory-card .card-back {
            background-color: #2563eb; /* Blue card back */
            color: white;
            font-size: 1.5rem;
        }

        body.dark .memory-card {
            background-color: #4b5563;
        }
        body.dark .memory-card .card-back {
            background-color: #4b5563;
        }
        body.dark .memory-card .card-face {
            background-color: #374151;
            color: #93c5fd;
        }
    </style>
</head>
<body class="font-vazirmatn antialiased">

    <div id="root" class="w-full h-full flex flex-col items-center justify-center"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        const ReactDOM = window.ReactDOM;

        const daily90DayEffects = [
            ["فعال‌سازی سیستم دوپامینی طبیعی", "کاهش سطح کورتیزول (هورمون استرس)", "تقویت ناحیه تصمیم‌گیری مغز (لوب پیش‌پیشانی)"],
            ["بازسازی حساسیت گیرنده‌های دوپامین", "افزایش نوروپلاستیسیته مغز", "کاهش اضطراب ناشی از پاداش فوری"],
            ["بهبود کیفیت خواب", "افزایش سطح سروتونین", "آرام‌تر شدن سیستم عصبی"],
            ["کاهش فعالیت آمیگدالا (مرکز هیجانات)", "تعادل هورمون تستوسترون", "کاهش مصرف گلوکز توسط مدار پاداش مغز"],
            ["افزایش هورمون‌های تنظیم جنسی (FSH و LH)", "تضعیف واکنش‌های شرطی به محرک‌ها", "بهبود تمرکز ذهنی"],
            ["بهبود حافظه کاری", "کاهش علائم افسردگی خفیف", "افزایش انرژی پایه بدن"],
            ["تعادل بیشتر در هورمون‌های مغزی و جنسی", "بهبود تصمیم‌گیری شناختی", "شروع تقویت مسیرهای عصبی سالم"],
            ["کاهش التهاب عصبی خفیف", "بهبود جریان خون مغزی", "افزایش ظرفیت تحمل استرس"],
            ["بازگشت ترشح طبیعی ملاتونین", "کاهش ضربان قلب در حالت استراحت", "افزایش حس آرامش عمومی"],
            ["تثبیت ریتم خواب-بیداری", "بهبود ریکاوری عضلانی در خواب", "کاهش سطح آنزیم‌های استرس‌زا در خون"],
            ["افزایش تولید BDNF (فاکتور نوروتروفیکی)", "تقویت سیناپس‌های جدید", "بهبود خلق‌وخو پایدار"],
            ["کاهش علائم اضطراب خفیف", "افزایش تحمل در مواجهه با محرک‌ها", "بهبود سیستم ایمنی به‌طور خفیف"],
            ["بهبود معیارهای متابولیک", "کاهش سطح گلوکز در خون پس از غذا", "افزایش کارایی متابولیسم انرژی"],
            ["تثبیت سروتونین و دوپامین در سطح متعادل", "بهبود عملکرد شناختی کوتاه‌مدت", "کاهش واکنش‌های فیزیولوژیک استرس"],
            ["افزایش حجم ماده خاکستری در لوب پیش‌پیشانی", "بهبود انعطاف‌پذیری شناختی", "کاهش احساس بی‌قراری فیزیکی"],
            ["کاهش نشانه‌های محرومیت دوپامینی", "تثبیت الگوی تنفس عمیق", "بهبود سطح انرژی پایدار در طول روز"],
            ["بازسازی شبکه عصبی پاداش طبیعی", "بهبود توانایی تمرکز طولانی‌مدت", "کاهش تمایل به جستجوی محرک سریع"],
            ["افزایش ترشح اندورفین‌های طبیعی", "کاهش دردهای عضلانی خفیف ناشی از استرس", "بهبود حس رضایت عمومی"],
            ["تثبیت هورمون‌های تیروئیدی", "افزایش متابولیسم پایه", "کاهش خستگی مزمن"],
            ["تقویت سیستم پاراتیروئید و تنظیم کلسیم", "بهبود تراکم استخوان (موقت)", "افزایش احساس سلامت اسکلتی"],
            ["تثبیت مسیرهای عصبی جدید (LTP پایدار)", "کاهش سطح نوراپی‌نفرین در حالت استراحت", "بهبود خونسازی مغز استخوان"],
            ["افزایش مقاومت در برابر استرس اکسیداتیو", "تقویت آنتی‌اکسیدان‌های طبیعی در خون", "کاهش التهاب سلولی"],
            ["بهبود توازن میکروبی روده", "کاهش سطوح التهابی سیستمیک", "افزایش جذب مواد مغذی"],
            ["تثبیت الگوی چرخه کورتیزول طبیعی", "کاهش اختلالات خواب مرتبط با استرس", "افزایش کیفیت استراحت شبانه"],
            ["افزایش حساسیت به انسولین", "بهبود کنترل قند خون", "کاهش خطر مقاومت به انسولین"],
            ["بازگشت سطح هورمون‌های تنظیم‌کننده خلق (نوراپی‌نفرین)", "بهبود رفتارهای تطابقی", "کاهش نوسانات شدید خلقی"],
            ["تثبیت فعالیت سیستم پاراتیروئید", "بهبود تنظیم الکترولیت‌ها", "کاهش دردهای مزمن عضلانی"],
            ["بازسازی سلول‌های عصبی ناحیه هیپوکامپ", "بهبود حافظه بلندمدت", "کاهش پیری شناختی"],
            ["کاهش سطح CRP (شاخص التهاب)", "بهبود عملکرد اندوتلیال عروقی", "کاهش فشار خون موضعی"],
            ["تثبیت بازده هیپوتالاموس–هیپوفیز–آدرنال", "بهبود تنظیم واکنش استرس مزمن", "کاهش علائم استرس طولانی‌مدت"],
            ["افزایش تولید میلین اطراف نورون‌ها", "بهبود سرعت انتقال عصبی", "افزایش هماهنگی شناختی"],
            ["کاهش سطح هورمون گرسنگی (گرلین)", "بهبود کنترل اشتها", "کاهش پرخوری عصبی خفیف"],
            ["بهبود عملکرد سیستم ایمنی سلولی (T-cell)", "افزایش توان مقابله با عفونت‌های خفیف", "کاهش دوره‌ی نقاهت پس از بیماری"],
            ["تثبیت سطح هورمون ملاتونین", "بهبود هماهنگی ریتم شبانه‌روزی", "کاهش بی‌خوابی خفیف"],
            ["افزایش تولید پروتئین‌های سرکوب استرس (HSP)", "تقویت پاسخ سلولی به تنش حرارتی", "افزایش بازسازی سلولی"],
            ["کاهش نشانه‌های افسردگی خفیف", "بهبود نقاط پایدار خلقی", "افزایش خودکارآمدی روانی"],
            ["تثبیت عملکرد شبکه مغزی پیش‌پیشانی", "بهبود توانایی برنامه‌ریزی و سازماندهی", "کاهش خطاهای شناختی"],
            ["افزایش سطح BDNF به حد بهینه", "تقویت سیناپس‌های هیپوکامپی", "بهبود یادگیری فضایی"],
            ["کاهش نشانه‌های خستگی ذهنی", "افزایش بازدهی توجه مزمن", "بهبود تمرکز در وظایف پیچیده"],
            ["تثبیت توازن نورون-گلیال", "بهبود عملکرد نورون‌های پشتیبان", "کاهش علائم خشکی چشم ناشی از استرس"],
            ["افزایش ظرفیت آنتی‌اکسیدان‌های عصبی (PCs)", "کاهش آسیب‌های اکسیداتیو در مغز", "بهبود انسجام شبکه عصبی"],
            ["بهبود جریان خون کورتیکال", "افزایش کارایی انتقال اکسیژن", "کاهش سردردهای تنشی"],
            ["تثبیت تولید نورآدرنالین سالم", "بهبود واکنش به محرک‌های ناگهانی", "کاهش لرزش‌های فیزیولوژیک"],
            ["افزایش تولید GABA (هورمون آرامش‌بخش)", "کاهش اضطراب عمومی", "بهبود آرامش ذهنی"],
            ["بهبود عملکرد هیپوتالاموس در تنظیم دما", "افزایش تحمل به تغییرات دمایی", "کاهش تعریق ناگهانی ناشی از استرس"],
            ["تثبیت سطح هورمون رشد انسانی (hGH)", "بهبود ریکاوری عضلانی", "افزایش سلامت پوست و مو"],
            ["کاهش نشانه‌های اختلال کم‌توجهی خفیف", "بهبود تمرکز پایدار در کلاس یا کار", "افزایش کارایی یادگیری"],
            ["افزایش ظرفیت تحمل درد خفیف", "بهبود آستانه تحمل در حالات فیزیکی", "کاهش حساسیت به سردرد تنشی"],
            ["تثبیت تولید آندورفین‌ها", "افزایش حس رضایت عمومی", "کاهش دردهای مزمن خفیف"],
            ["بهبود عملکرد مغز در شرایط گرسنگی خفیف", "افزایش انعطاف‌پذیری متابولیکی", "کاهش نوسانات سطح قند خون"],
            ["افزایش تولید استیل‌کولین", "بهبود حافظه و یادآوری اطلاعات", "افزایش سرعت واکنش ذهنی"],
            ["بهبود توازن هورمون‌های جنسی در زنان", "کاهش سندرم پیش از قاعدگی خفیف", "افزایش ثبات خلقی در سیکل ماهانه"],
            ["تثبیت سطح هورمون نوروتروفین‌ها", "بهبود سلامت نوروژنیک", "کاهش پیشرفت پیر شدن سلولی عصبی"],
            ["افزایش ظرفیت حافظه اپیزودیک", "بهبود یادگیری تجربی", "کاهش گسیختگی حافظه"],
            ["کاهش التهابات عروقی مغزی", "بهبود کارایی عروقی و اکسیژن‌رسانی", "کاهش سردردهای میگرنی خفیف"],
            ["تثبیت سطح کورتیزول در پاسخ به استرس مزمن", "افزایش مقاومت روانی در شرایط دشوار", "کاهش علائم PTSD خفیف (در صورت وجود)"],
            ["افزایش تراکم مغزی ناحیه هیپوکامپ", "بهبود حافظه فضایی و یادگیری", "کاهش افت شناختی آ‌غازین"],
            ["تقویت عملکرد سیستم دفاعی مغز (توسط میکروگلیا)", "کاهش آسیب‌های عصبی التهابی", "بهبود سلامت سلولی مغزی"],
            ["بهبود تنظیم هورمون‌های تنظیم‌کننده اشتها", "کاهش پرخوری عصبی احتمالی", "افزایش کنترل رفتار غذایی"],
            ["تثبیت ریتم کورتیزول-ملاتونین شبانه‌روزی", "بهبود کیفیت کامل خواب", "کاهش اختلالات خواب خفیف"],
            ["افزایش ظرفیت حافظه کاری بلندمدت", "بهبود توانایی انجام چندکار هم‌زمان", "کاهش خطاهای تصمیم‌گیری"],
            ["کاهش التهابات سیستمیک بدن", "بهبود سلامت قلب و عروق", "کاهش سطح CRP تا حد نرمال"],
            ["تثبیت تولید دوپامین پایدار", "بهبود واکنش مناسب به پاداش طبیعی", "کاهش جستجوی سریع لذت"],
            ["افزایش تولید نورون‌های جدید در هیپوکامپ", "بهبود نوروجنسیس", "کاهش خطر افسردگی در آینده"],
            ["بهبود عملکرد شناختی تحت فشار", "افزایش تحمل به محرک‌های استرس‌زا", "کاهش واکنش‌های فیزیولوژیک شدید"],
            ["تثبیت سطح هورمون پروژسترون (در زنان)", "بهبود تعادل هورمونی سیکلی", "کاهش سندرم پیش‌قاعدگی"],
            ["افزایش انعطاف‌پذیری سیناپسی", "بهبود یادگیری مهارت‌های جدید", "کاهش سختی در تغییر عادت‌ها"],
            ["کاهش آسیب اکسیداتیو به پروتئین‌های مغزی", "بهبود پایداری پروتئین‌های عصبی", "کاهش نشانه‌های پیری نورون"],
            ["تثبیت فعالیت نرون‌های دوپامینرژیک", "بهبود تعادل روانی و انگیزشی", "کاهش افکار وسواسی"],
            ["افزایش عملکرد هیپوکامپ در ذخیره‌سازی حافظه", "بهبود یادگیری اطلاعات جدید", "کاهش فراموشی نامرتبط"],
            ["کاهش التهاب سیستمیک تا سطح نرمال", "تقویت سیستم ایمنی لایه‌ای (سلولی)", "کاهش دوره‌ی نقاهت بیماری‌های جزئی"],
            ["تثبیت تولید سروتونین", "بهبود خلق‌وخو پایدار", "کاهش نشانه‌های اضطراب عمومی"],
            ["افزایش جذب میکروالکترولیت‌ها در روده", "بهبود توازن الکترولیتی", "کاهش گرفتگی‌های عضلانی"],
            ["کاهش سطح هورمون غدد فوق کلیوی", "بهبود تنظیم فشار خون", "کاهش تنش عروقی"],
            ["افزایش تولید آنتی‌بادی‌های ایمنی", "بهبود عملکرد لنفوسیت‌ها", "کاهش زخم‌های کوچک و تسریع بهبود"],
            ["تثبیت عملکرد کبد در سم‌زدایی", "بهبود سطح آنزیم‌های کبدی", "کاهش سموم در خون"],
            ["افزایش ظرفیت ریه در تبادل اکسیژن", "بهبود عملکرد تنفسی", "کاهش تنگی نفس خفیف"],
            ["بهبود قدرت عضلانی خفیف", "افزایش سنتز پروتئین عضلانی", "کاهش خستگی عضلانی"],
            ["تثبیت سطح هورمون رشد", "بهبود فرآیند بازسازی بافت‌ها", "افزایش سلامت پوستی"],
            ["کاهش نشانه‌های پیری سلولی", "تقویت تلومرها", "بهبود عمر مفید سلول‌های بنیادی"],
            ["افزایش کارایی شبکه پیش‌پیشانی", "بهبود توانایی کنترل تکانه‌ها", "کاهش تصمیم‌گیری‌های شتاب‌زده"],
            ["تثبیت سطح GABA و گلایسین", "بهبود اثرات آرامش‌بخش طبیعی", "کاهش بی‌قراری ذهنی"],
            ["بهبود خون‌رسانی به نواحی حسی مغز", "افزایش کارایی ادراکی", "کاهش سرگیجه خفیف"],
            ["کاهش مقدار هورمون استرس زیر آستانه", "بهبود پاسخ ایمنی به استرس", "کاهش سطح آدرنالین پایه"],
            ["تثبیت توازن هورمون‌های تنظیم‌کننده اشتها", "افزایش کنترل وزن پایدار", "کاهش خطر چاقی عصبی"],
            ["افزایش سطح اندورفین‌ها در طول فعالیت بدنی", "بهبود تحمل ورزشی", "کاهش درد پس از تمرین"],
            ["تقویت عملکرد سیناپسی در ناحیه قشر حرکتی", "افزایش هماهنگی حرکتی", "کاهش لرزش نواحی ظریف"],
            ["تثبیت تولید ملاتونین در طول شب", "بهبود کیفیت خواب عمیق (REM)", "کاهش خواب‌آلودگی روزانه"],
            ["افزایش توان مقابله با محرک‌های اعتیادآور", "تقویت شبکه‌های عصبی محافظ در برابر وسوسه", "کاهش ولع‌های لحظه‌ای"],
            ["تثبیت کامل مسیرهای عصبی جدید سالم", "سطح متعادل تمام هورمون‌های مرتبط با استرس و پاداش", "افزایش کیفیت زندگي جسمی و روانی پایدار"],
        ];

        const motivationalMessages = [
            "هر روز یک قدم به سوی آزادی بیشتر.",
            "قدرت درونی شما بی‌نهایت است.",
            "شما قوی‌تر از هر وسوسه‌ای هستید.",
            "به خودت افتخار کن، تو داری تغییر می‌کنی.",
            "امروز، فردای بهتری را بساز.",
            "تسلیم نشو، بهترین‌ها در راهند.",
            "هر لحظه انتخابی برای پیروزی است.",
            "شجاعت شما، الهام‌بخش دیگران است.",
            "به یاد داشته باش چرا شروع کردی.",
            "در این مسیر تنها نیستی، ما با توایم.",
            "هر روز، فرصتی تازه برای درخشش است.",
            "خودت را باور کن، تو می‌توانی.",
            "قوی بمان، آینده از آن توست.",
            "نفس عمیق بکش و ادامه بده.",
            "هر قدم کوچک، پیروزی بزرگی است.",
            "آرام باش، قدرت در سکوت توست.",
            "تو قهرمان زندگی خودت هستی.",
            "این مبارزه تو را قوی‌تر می‌کند.",
            "به یاد داشته باش که چقدر پیشرفت کرده‌ای.",
            "هر روز، تو بهتر می‌شوی.",
            "مهم نیست چقدر آهسته می‌روی، مهم این است که متوقف نمی‌شوی.",
            "شادی و سلامتی در انتظار توست.",
            "اراده تو، مسیر تو را می‌سازد.",
            "به سوی روشنایی حرکت کن.",
            "این تغییر، ارزشمندترین هدیه به خودت است.",
            "لحظات سخت، پایدار نیستند، اما افراد سخت‌کوش پایدارند.",
            "از هر اشتباهی درس بگیر و قوی‌تر شو.",
            "تو لیاقت بهترین‌ها را داری.",
            "آینده‌ای روشن در انتظار توست.",
            "تو خالق سرنوشت خود هستی.",
            "تو لیاقت یک زندگی سالم‌تر را داری.",
            "هر روز یک شروع تازه است.",
            "به نیروی درونی خودت اعتماد کن.",
            "تصمیم امروزت، آینده‌ات را می‌سازد.",
            "شادی واقعی در رهایی است.",
            "مسیرت را ادامه بده، قله نزدیک است.",
            "تو قوی‌تر از آنچه فکر می‌کنی هستی.",
            "به خاطر خودت و آینده‌ات تلاش کن.",
            "هیچ‌چیز ارزش از دست دادن سلامتی تو را ندارد.",
            "نفس بکش و آرام باش، تو کنترل اوضاع را در دست داری.",
            "هر چالش، فرصتی برای رشد است.",
            "با هر انتخاب سالم، به خودت هدیه می‌دهی.",
            "به یاد بیاور که چقدر پیشرفت کرده‌ای.",
            "تو تنها نیستی، ما از تو حمایت می‌کنیم.",
            "این لحظه می‌گذرد، مقاومت کن.",
            "هدفمند زندگی کن.",
            "تو توانایی‌های بی‌حد و حصری داری.",
            "از اشتباهاتت درس بگیر و قوی‌تر شو.",
            "به سوی آزادی واقعی گام بردار.",
            "تو می‌درخشی، ادامه بده."
        ];

        const reasonsToQuit = [
            "برای سلامتی بهتر",
            "برای خانواده‌ام",
            "برای آینده‌ام",
            "برای حس آزادی",
            "برای افزایش اعتماد به نفس",
            "برای رسیدن به آرامش واقعی",
            "برای الگو بودن برای دیگران",
            "برای انرژی بیشتر در طول روز",
            "برای تمرکز بهتر روی اهدافم",
            "برای زندگی طولانی‌تر و سالم‌تر",
            "برای داشتن روابط عمیق‌تر",
            "برای رهایی از حس شرم و گناه",
            "برای شکوفایی توانایی‌هایم",
            "برای لذت بردن از لحظات ساده زندگی",
            "برای بهبود وضعیت مالی‌ام",
            "برای داشتن خوابی آرام",
            "برای ذهنی باز و روشن",
            "برای رهایی از وابستگی",
            "برای احترام به جسم و روحم",
            "برای داشتن کنترل بر زندگی‌ام",
            "برای کاهش استرس و اضطراب",
            "برای افزایش خودباوری",
            "برای یافتن شادی پایدار",
            "برای داشتن وقت بیشتر برای علایقم",
            "برای رهایی از قضاوت دیگران",
            "برای آینده‌ای که خودم می‌سازم",
            "برای تجربه‌های جدید و هیجان‌انگیز",
            "برای شادابی و نشاط دائمی",
            "برای سلامت روانی‌ام",
            "برای احساس قدرت و توانمندی",
            "برای دستیابی به اهداف بزرگترم",
            "برای داشتن یک زندگی آرام‌تر",
            "برای سلامتی روانیم",
            "برای اینکه الگوی خوبی برای فرزندانم باشم",
            "برای رهایی از چرخه اعتیاد",
            "برای بازگرداندن شادی به زندگی‌ام",
            "برای اینکه خودم را اثبات کنم",
            "برای افزایش انرژی و توانایی انجام کارهای روزانه",
            "برای جلوگیری از پشیمانی در آینده",
            "برای تجربه زندگی بدون وابستگی",
            "برای تمرکز کامل بر کار و علایقم",
            "برای بهبود وضعیت مالی",
            "برای دیدن ارزش واقعی خودم",
            "برای داشتن یک ذهن شفاف",
            "برای اینکه کنترل زندگی‌ام را به دست بگیرم",
            "برای کاهش تأثیرات منفی بر عزیزانم",
            "برای تجربه حس واقعی آزادی",
            "برای شروع یک فصل جدید در زندگی",
            "برای اینکه به قول خودم وفادار بمانم",
            "برای آینده‌ای روشن و پر امید"
        ];

        const challengeList = [
            "امروز، به جای انجام عادت بد، ۵ دقیقه مدیتیشن کن.",
            "یک لیوان آب اضافی بنوش.",
            "برای ۱۵ دقیقه پیاده‌روی برو.",
            "با یک دوست یا عضو خانواده صحبت کن و حال خوبت رو باهاش به اشتراک بذار.",
            "یک کار کوچیک و مثبت برای کسی دیگه انجام بده.",
            "برای ۱۰ دقیقه روی اهدافت تمرکز کن.",
            "یک آهنگ شاد گوش کن و باهاش همخوانی کن.",
            "یک غذای سالم و جدید امتحان کن.",
            "به خودت یک هدیه کوچیک بده (نه چیزی که به عادت بدت ربط داشته باشه).",
            "یک لبخند به ۳ نفر غریبه بزن.",
            "به یک فیلم یا مستند الهام‌بخش نگاه کن.",
            "برای ۲۰ دقیقه کتاب بخون.",
            "یک چیز جدید یاد بگیر (یک کلمه، یک اصطلاح، یک واقعیت جالب).",
            "اتاق یا میز کار خودت رو مرتب کن.",
            "۵ بار نفس عمیق بکش و بازدم کن.",
            "یک نامه قدردانی به کسی که دوستش داری بنویس.",
            "برای ۳۰ دقیقه از شبکه‌های اجتماعی دور باش.",
            "یک پازل حل کن یا یک بازی فکری انجام بده.",
            "به صدای طبیعت گوش کن.",
            "یک لیست از ۱۰ چیزی که بابتشون شکرگزار هستی، بنویس.",
            "برای خودت یک هدف کوچک روزانه تعیین کن و بهش برس.",
            "به جای فکر کردن به وسوسه، به سه دلیل برای ترک فکر کن.",
            "یک ورزش سبک مثل کشش یا یوگا انجام بده.",
            "خودت رو با یک دوش آب سرد یا ولرم سرحال کن.",
            "یک نقاشی ساده بکش یا کاری هنری انجام بده.",
            "با دقت به اطرافت نگاه کن و ۵ چیز آبی را پیدا کن.",
            "برنامه‌ریزی برای فردایت را بنویس.",
            "یک داستان کوتاه انگیزشی بخون.",
            "برای ۵ دقیقه چشماتو ببند و آرامش رو تصور کن.",
            "یک کار ناتمام رو به پایان برسون.",
            "امروز، یک وعده غذایی کاملاً سالم بخور.",
            "قبل از خواب، ۱۰ دقیقه کتاب بخوان.",
            "یک مهارت جدید را به صورت آنلاین یاد بگیر.",
            "به جای واکنش، امروز فقط مشاهده‌گر باش.",
            "بدون استفاده از موبایل، با یکی از اعضای خانواده صحبت کن.",
            "۵ دقیقه در سکوت کامل بنشین.",
            "یک کار خیر کوچک برای کسی انجام بده.",
            "به ۵ نفر از افرادی که برایشان ارزش قائلی، پیام تشکر بفرست.",
            "یک برنامه غذایی سالم برای هفته آینده‌ات بنویس.",
            "برای ۳۰ دقیقه موسیقی آرامش‌بخش گوش کن.",
            "کشش‌های ساده بدنی را به مدت ۱۰ دقیقه انجام بده.",
            "یک لیست از کارهایی که به تعویق انداخته‌ای، تهیه کن.",
            "یک هدف جدید برای خودت تعیین کن.",
            "برای خودت یک فنجان چای گیاهی درست کن و آرام بنوش.",
            "به یک پادکست انگیزشی گوش بده.",
            "به جای قضاوت، امروز فقط همدلی کن.",
            "یک مکان جدید در شهرت را کشف کن (حتی یک پارک کوچک).",
            "برای ۳ دقیقه چشمانت را ببند و به صدای محیط گوش کن.",
            "به جای شکایت، به یک راه حل فکر کن.",
            "برای ۵ دقیقه به خودت در آینه لبخند بزن."
        ];

        const recommendationsList = [
            "برای حفظ انگیزه، هر روز دلایلت برای ترک را مرور کن.",
            "ورزش منظم را در برنامه روزانه‌ات بگنجان؛ حتی ۱۰ دقیقه پیاده‌روی هم مؤثر است.",
            "از افراد و موقعیت‌هایی که وسوسه‌ات می‌کنند، دوری کن.",
            "یک سرگرمی جدید پیدا کن که ذهنت را مشغول کند.",
            "به اندازه کافی بخواب و استراحت کن تا بدنت بازیابی شود.",
            "رژیم غذایی سالم و متعادل داشته باش.",
            "در صورت نیاز، از یک مشاور یا درمانگر کمک بگیر.",
            "با خانواده و دوستانت در مورد پیشرفت‌هایت صحبت کن.",
            "اهداف کوچک و قابل دسترس برای خودت تعیین کن و به آن‌ها متعهد باش.",
            "برای خودت پاداش‌های کوچک و سالم در نظر بگیر.",
            "به خودت یادآوری کن که هر لغزش، پایان راه نیست؛ دوباره شروع کن.",
            "روش‌های آرامش‌بخش مانند مدیتیشن یا یوگا را امتحان کن.",
            "لیستی از فعالیت‌های جایگزین برای لحظات وسوسه تهیه کن.",
            "در گروه‌های حمایتی شرکت کن تا از تجربیات دیگران استفاده کنی.",
            "زمان‌هایی که بیشتر وسوسه می‌شوی را شناسایی کن و برایشان برنامه داشته باش.",
            "ذهن‌آگاهی (Mindfulness) را تمرین کن تا در لحظه حال زندگی کنی.",
            "صبور باش؛ تغییر زمان می‌برد.",
            "به بدن خود گوش کن و نیازهایش را برطرف کن.",
            "مثبت‌اندیشی را در خودت تقویت کن.",
            "از تکنیک‌های تنفس عمیق برای مدیریت استرس استفاده کن.",
            "کتاب‌های انگیزشی یا خودسازی بخوان.",
            "هر روز صبح با یک جمله انگیزشی شروع کن.",
            "موفقیت‌های کوچک روزانه‌ات را جشن بگیر.",
            "سعی کن هر روز چیزی جدید یاد بگیری.",
            "برای آینده‌ات برنامه‌ریزی کن و به آن متعهد باش.",
            "به جای مقایسه خودت با دیگران، روی پیشرفت خودت تمرکز کن.",
            "برای خودت فضای آرامی برای استراحت و تفکر ایجاد کن.",
            "با طبیعت ارتباط برقرار کن؛ قدم قدم زدن در پارک یا فضای سبز.",
            "به موسیقی آرامش‌بخش گوش کن.",
            "به خودت مهربان باش و از سرزنش خودت دست بردار.",
            "به خودت یادآوری کن که تو قوی‌تر از هر وسوسه‌ای هستی.",
            "یک سرگرمی جدید که به سلامتی‌ات کمک کند، پیدا کن.",
            "با افرادی که سبک زندگی سالمی دارند، وقت بگذرانید.",
            "لیستی از تمام دلایلی که برای ترک عادت بد داری را بنویس.",
            "هر روز یک کار مثبت برای خودت انجام بده.",
            "به حس‌های درونی‌ات گوش کن و به آنها احترام بگذار.",
            "یاد بگیر چگونه احساساتت را به شیوه سالم بیان کنی.",
            "بر روی ساختن یک زندگی متعادل تمرکز کن.",
            "به خاطر هر قدم کوچکی که برمی‌داری، به خودت افتخار کن.",
            "یک برنامه روتین روزانه سالم برای خودت ایجاد کن.",
            "از مقایسه خودت با گذشته‌ات دست بردار و به پیشرفت‌هایت نگاه کن.",
            "از تمام چیزهایی که به دست آورده‌ای، قدردانی کن.",
            "برای روزهایی که احساس ضعف می‌کنی، یک برنامه پشتیبانی داشته باش.",
            "به خودت اجازه بده که گاهی اوقات اشتباه کنی و دوباره شروع کنی.",
            "به جای نگرانی درباره آینده، بر روی امروز تمرکز کن.",
            "با دوستان و خانواده‌ات درباره مسیرت صحبت کن.",
            "تکنیک‌های آرامش‌بخش مانند یوگا یا مدیتیشن را امتحان کن.",
            "خودت را با فعالیت‌های مثبت و سازنده مشغول کن.",
            "در هر لحظه، بهترین نسخه از خودت باش.",
            "به یاد داشته باش که این سفر، ارزشش را دارد."
        ];

        const rewardMessages = [
            "تبریک! هر روز پاکی شما یک پیروزی بزرگ است.",
            "آفرین بر شما! این نشان‌دهنده قدرت و اراده شماست.",
            "شما فوق‌العاده‌اید! به این مسیر پرقدرت ادامه دهید.",
            "یک قهرمان واقعی! هر روز بهتر از دیروز.",
            "پیشرفت شما بی‌نظیر است. به خودتان افتخار کنید.",
            "تبریک! این پایداری شما الهام‌بخش است.",
            "بسیار عالی! شما هر روز به آزادی نزدیک‌تر می‌شوید.",
            "اراده شما مثال‌زدنی است. ادامه بدهید!",
            "شما بی‌نظیرید! این پیروزی‌های کوچک، راهگشای موفقیت‌های بزرگند.",
            "تبریک! شما در حال ساختن بهترین نسخه از خودتان هستید.",
            "به این پایداری، شجاعت و خودکنترلی افتخار می‌کنیم.",
            "هر روزی که پاک می‌مانید، پاداشی برای روح و جسم شماست.",
            "مسیر شما پر از دستاورد است. به خودتان اعتبار بدهید.",
            "قدرت درونی شما بی‌حد و حصر است. این را به یاد داشته باشید.",
            "شما نمادی از اراده و تغییر مثبت هستید.",
            "واقعاً تحسین‌برانگیز! شما در حال پس گرفتن زندگی‌تان هستید.",
            "این پیروزی‌ها، گواه قدرت شماست. به پیش بروید!",
            "شما در حال تبدیل شدن به کسی هستید که همیشه آرزویش را داشتید.",
            "تبریک! شما ارزش این همه تلاش را دارید.",
            "هر روز پاکی، یک ستاره درخشان در آسمان زندگی شماست.",
            "با هر روز، اعتماد به نفس و آرامش بیشتری به دست می‌آورید.",
            "شما در مسیر درستی قرار دارید. ادامه دهید با قدرت!",
            "این حس رهایی، بهترین پاداش است. آن را حفظ کنید.",
            "شما به خودتان ثابت کردید که می‌توانید. این پیروزی را جشن بگیید.",
            "تبریک! به این اراده قوی‌تان ببالید.",
            "قدم به قدم، شما در حال فتح قله‌های جدید هستید.",
            "قدرت شما در انتخاب‌های روزانه‌تان نهفته است. آفرین!",
            "شما هر روز الهام‌بخش‌تر می‌شوید.",
            "از این دستاورد لذت ببرید، شما سزاوارش هستید.",
            "تبریک! شما یک زندگی جدید و درخشان را شروع کرده‌اید.",
            "تبریک، شما در حال خلق یک داستان موفقیت هستید!",
            "آفرین، این اراده شما بی‌نظیر است.",
            "شما لیاقت تمام خوبی‌های دنیا را دارید، به این راه ادامه دهید.",
            "هر روز پاکی شما، یک برگ زرین در کتاب زندگی‌تان است.",
            "شما یک قهرمان درون خود دارید، آن را آزاد کنید.",
            "این پیروزی‌ها، نشانه‌هایی از قدرت درونی شماست.",
            "به این پیشرفت چشمگیرتان افتخار کنید.",
            "شما در حال تبدیل شدن به بهترین نسخه خود هستید.",
            "تبریک! شما آزاد شده‌اید.",
            "پاداش شما، سلامتی و آرامش است.",
            "هر روز پاکی، یک قدم به سوی زندگی رؤیایی شماست.",
            "این حس خوب رهایی، پاداش تلاش‌های شماست.",
            "شما در حال الهام‌بخشیدن به دیگران هستید.",
            "به خودتان پاداش بدهید، شما سزاوارید.",
            "تبریک! این سفر ارزش هر سختی را داشت.",
            "شجاعت شما ستودنی است.",
            "به خودتان باور داشته باشید، شما معجزه می‌کنید.",
            "این آزادی، از جنس طلاست.",
            "هر روز، گواهی بر قدرت بی‌انتهای شماست.",
            "شما یک نمونه عالی از اراده و پشتکارید."
        ];
        
        const analyzeTemptationStrategies = [
            "یک: محرک‌ها را شناسایی کنید. چه زمانی و در چه مکان‌هایی وسوسه می‌شوید؟ افراد یا احساسات خاصی دخیل هستند؟ با شناخت این محرک‌ها، می‌توانید از آن‌ها دوری کنید یا برای مواجهه با آن‌ها آماده شوید.",
            "دو: راهکارهای جایگزین سالم ایجاد کنید. به جای انجام عادت بد، چه کار دیگری می‌توانید انجام دهید که به شما حس خوبی بدهد؟ (مثلاً ورزش، خواندن کتاب، صحبت با یک دوست). لیستی از این جایگزین‌ها را همیشه همراه داشته باشید.",
            "سه: یک سیستم پشتیبانی بسازید. با یک دوست، عضو خانواده یا مربی در ارتباط باشید که در لحظات وسوسه می‌توانید با او صحبت کنید. حمایت دیگران در این مسیر بسیار ارزشمند است.",
            "چهار: تنفس عمیق یا مدیتیشن را تمرین کنید. در لحظه وسوسه، چند نفس عمیق بکشید. این کار به آرامش سیستم عصبی شما کمک می‌کند و فرصت می‌دهد تا تصمیمی آگاهانه بگیرید.",
            "پنج: به یاد داشته باشید چرا شروع کردید. مرور دلایل اصلی شما برای ترک عادت بد، می‌تواند انگیزه لازم را برای غلبه بر وسوسه به شما بدهد.",
            "شش: از تکنیک تأخیر استفاده کنید. به خودتان بگویید که می‌توانید عادت بد را انجام دهید، اما ۱۵ دقیقه دیگر. در این مدت، خود را با کاری دیگر مشغول کنید. اغلب اوقات، وسوسه از بین می‌رود.",
            "هفت: محیط خود را تغییر دهید. اگر مکان خاصی باعث وسوسه می‌شود، از آن دوری کنید. اگر وسایل خاصی شما را یاد عادت بد می‌اندازد، آن‌ها را حذف یا پنهان کنید.",
            "هشت: به خودتان پاداش بدهید. وقتی بر یک وسوسه غلبه می‌کنید، به خودتان پاداش‌های کوچک و سالم (غیر مرتبط با عادت بد) بدهید تا مغزتان ارتباط مثبتی با مقاومت پیدا کند.",
            "نه: از افکار منفی دوری کنید. افکار خود را به سمت چیزهای مثبت هدایت کنید. تمرکز بر آنچه به دست آورده‌اید، نه آنچه از دست داده‌اید.",
            "ده: به خودتان یادآوری کنید که این فقط یک لحظه است. وسوسه‌ها معمولاً گذرا هستند. لحظات سخت می‌گذرند و شما قوی‌تر می‌شوید.",
            "یازده: برای جلوگیری از خستگی ذهنی، به اندازه کافی استراحت کنید. کمبود خواب می‌تواند مقاومت شما را کاهش دهد.",
            "دوازده: از نوشیدن آب کافی و تغذیه سالم اطمینان حاصل کنید. بدن سالم، ذهن سالمی دارد.",
            "سیزده: یک ژورنال بنویسید. احساسات، پیشرفت‌ها و چالش‌های خود را ثبت کنید. این به شما کمک می‌کند الگوها را بشناسید.",
            "چهارده: مهارت‌های مقابله‌ای جدید بیاموزید. کتاب بخوانید، پادکست گوش دهید، یا در کارگاه‌های آموزشی شرکت کنید.",
            "پانزده: هدف‌گذاری کوچک کنید. اهداف روزانه یا هفتگی برای خودتان تعیین کنید و با رسیدن به آن‌ها، حس موفقیت را تقویت کنید.",
            "شانزده: به خودتان اجازه دهید که کامل نباشید. اشتباهات جزئی بخشی از فرآیند هستند. مهم این است که دوباره بلند شوید.",
            "هفده: فعالیت‌های فیزیکی را به برنامه روزانه خود اضافه کنید. ورزش به آزاد شدن اندورفین‌ها و کاهش استرس کمک می‌کند.",
            "هجده: یک روال صبحگاهی مثبت داشته باشید. شروع روز با مدیتیشن یا جملات تاکیدی می‌تواند انگیزه شما را بالا ببرد.",
            "نوزده: با دوستان یا خانواده خود برنامه‌های جایگزین ترتیب دهید. فعالیت‌های اجتماعی سالم می‌تواند حواس شما را پرت کند.",
            "بیست: از خودگویی مثبت استفاده کنید. به جای سرزنش خود، با خودتان مهربان باشید و جملات انگیزشی بگویید.",
            "بیست و یک: به دنبال الهام باشید. داستان‌های موفقیت دیگران را بخوانید یا به پادکست‌های انگیزشی گوش دهید.",
            "بیست و دو: تمرکز بر اهداف بلندمدت خود را حفظ کنید. این وسوسه کوتاه‌مدت را با آینده‌ای که می‌خواهید بسازید، مقایسه کنید.",
            "بیست و سه: برای لحظات کسالت برنامه داشته باشید. کسالت اغلب محرک عادت‌های بد است.",
            "بیست و چهار: اگر لازم شد، برای مدتی از شبکه‌های اجتماعی یا هر محرک دیجیتالی که وسوسه ایجاد می‌کند، دور شوید.",
            "بیست و پنج: یک مکان امن ذهنی برای خود ایجاد کنید. مکانی آرام که در لحظات استرس می‌توانید به آن پناه ببرید.",
            "بیست و شش: موسیقی درمانی را امتحان کنید. گوش دادن به موسیقی آرامش‌بخش یا انرژی‌بخش می‌تواند خلق‌وخوی شما را تغییر دهد.",
            "بیست و هفت: برای حل مشکلات اساسی که منجر به عادت بد می‌شوند، کمک بگیرید.",
            "بیست و هشت: تمرین شکرگزاری کنید. هر روز برای چیزهایی که دارید، شکرگزاری کنید.",
            "بیست و نه: به یاد داشته باشید که شما در حال کنترل زندگی خود هستید، نه عادت‌هایتان.",
            "سی: جشن بگیرید که هر روز بر وسوسه‌ها غلبه می‌کنید و قوی‌تر می‌شوید.",
            "سی و یک: از تغییرات کوچک شروع کنید. نیازی نیست همه چیز را یکباره تغییر دهید.",
            "سی و دو: برای هر وسوسه‌ای که با آن مقابله می‌کنید، یک یادداشت کوچک برای خودتان بنویسید.",
            "سی و سه: به جای تمرکز بر آنچه از دست می‌دهید، به آنچه به دست می‌آورید فکر کنید.",
            "سی و چهار: از ابزارهای تکنولوژی برای کمک به خود استفاده کنید (مثلاً اپلیکیشن‌های ترک عادت).",
            "سی و پنج: به خودتان اجازه دهید که احساساتتان را تجربه کنید، حتی اگر منفی باشند.",
            "سی و شش: از یک برنامه \"پاداش‌های سالم\" برای انگیزه دادن به خودتان استفاده کنید.",
            "سی و هفت: برای مدیریت زمان خود برنامه‌ریزی کنید تا کمتر در معرض موقعیت‌های تحریک‌کننده قرار بگیرید.",
            "سی و هشت: یک \"فهرست ممنوعه‌ها\" برای خودتان ایجاد کنید (چیزهایی که شما را به سمت عادت بد می‌کشند).",
            "سی و نه: مهارت‌های جدیدی را بیاموزید که ذهن شما را مشغول نگه دارد.",
            "چهل: به خودتان یادآوری کنید که هر روز یک فرصت جدید برای پیروزی است.",
            "چهل و یک: یک \"جمله کلیدی\" برای خودتان داشته باشید که در لحظه وسوسه آن را تکرار کنید.",
            "چهل و دو: به صورت منظم مدیتیشن کنید تا کنترل بیشتری بر افکارتان داشته باشید.",
            "چهل و سه: از قدرت تجسم استفاده کنید؛ خودتان را در حال زندگی بدون آن عادت تصور کنید.",
            "چهل و چهار: اگر لغزشی داشتید، خودتان را سرزنش نکنید و دوباره شروع کنید.",
            "چهل و پنج: برای هر موفقیت کوچک، به خودتان پاداش‌های غیرغذایی بدهید.",
            "چهل و شش: با افرادی که شما را به سمت عادت بد سوق می‌دهند، مرزهای مشخصی تعیین کنید.",
            "چهل و هفت: به دنبال فعالیت‌های اجتماعی باشید که به سلامتی شما کمک می‌کنند.",
            "چهل و هشت: یاد بگیرید که چگونه با اضطراب و ناراحتی به شیوه‌های سالم‌تر کنار بیایید.",
            "چهل و نه: یک \"جعبه ابزار مقابله\" برای خودتان ایجاد کنید که شامل وسایل آرامش‌بخش باشد.",
            "پنجاه: به یاد داشته باشید که هر انتخابی که امروز می‌کنید، آینده شما را شکل می‌دهد."
        ];
        
        const progressReports = [
            "تبریک به شما، [نام کاربر]! [روزهای پاک] روز بی‌نظیر از تعهد شما به سلامتی می‌گذرد. از [تاریخ شروع]، هر روز شما گامی محکم به سوی رهایی بوده است. با [تعداد وسوسه‌ها] بار مقابله، شما قدرت فوق‌العاده‌ای در کنترل خود نشان داده‌اید. به این مسیر درخشان ادامه دهید.",
            "تبریک به [نام کاربر] عزیز! [روزهای پاک] روز از رهایی، نتیجه تلاش‌های بی‌وقفه شماست. از [تاریخ شروع] تا به امروز، هر انتخابتان، شما را قوی‌تر کرده است. با [تعداد وسوسه‌ها] وسوسه که از آن‌ها عبور کرده‌اید، ثابت کردید که شکست‌ناپذیرید. به این موفقیت ببالید!",
            "آفرین به [نام کاربر] شجاع! [روزهای پاک] روز از سفر قهرمانانه‌تان به سوی آزادی می‌گذرد. [تاریخ شروع] آغاز فصلی نو در زندگی شما بود. هرچند [تعداد وسوسه‌ها] بار با چالش روبرو شدید، اما هر بار با اراده‌ای قوی‌تر بازگشتید. این است رمز پیروزی شما.",
            "[نام کاربر]، شما بی‌نظیرید! [روزهای پاک] روز پاکی، گواه این است که شما خالق زندگی خود هستید. از [تاریخ شروع]، شما با هر نفس، به سوی زندگی ایده‌آلتان حرکت کرده‌اید. با [تعداد وسوسه‌ها] بار مقابله با وسوسه، شما مهارت‌های ارزشمندی کسب کرده‌اید. این راه را با قدرت ادامه دهید.",
            "تبریک فراوان به [نام کاربر]! [روزهای پاک] روز، یک دستاورد فراموش‌نشدنی است. از [تاریخ شروع]، شما با عزمی پولادین پیش رفته‌اید. حتی با [تعداد وسوسه‌ها] چالش، شما نشان دادید که هیچ‌چیز نمی‌تواند جلوی شما را بگیرد. به این مسیر پر از افتخار ادامه دهید.",
            "[نام کاربر] عزیز، [روزهای پاک] روز از این مسیر مقدس می‌گذرد. [تاریخ شروع]، روزی بود که شما تصمیم گرفتید آینده‌ای روشن‌تر بسازید. با [تعداد وسوسه‌ها] بار مقابله با وسوسه، شما شجاعت و استقامت خود را ثابت کرده‌اید. این پیشرفت، قابل تحسین است.",
            "درود بر [نام کاربر] گرامی! [روزهای پاک] روز پاکی، نمادی از پایداری و قدرت درونی شماست. از [تاریخ شروع]، شما به خودتان ثابت کرده‌اید که می‌توانید. هرچند [تعداد وسوسه‌ها] بار با چالش مواجه شدید، اما هر بار با تصمیم قوی‌تر به جلو رفتید. ادامه این مسیر را با افتخار جشن بگیرید.",
            "[نام کاربر]، شما یک نمونه عالی از اراده هستید! [روزهای پاک] روز از این سفر هیجان‌انگیز می‌گذرد. از [تاریخ شروع]، شما در حال تغییر زندگی‌تان هستید. با [تعداد وسوسه‌ها] بار مقابله، شما مهارت‌های مدیریت وسوسه را فرا گرفته‌اید. این پیروزی‌ها را به خودتان تبریک بگویید.",
            "تبریک به [نام کاربر]! [روزهای پاک] روز از این راه پر برکت می‌گذرد. [تاریخ شروع]، روزی بود که شما کنترل زندگی‌تان را به دست گرفتید. با [تعداد وسوسه‌ها] بار غلبه بر وسوسه، شما نشان دادید که چقدر قدرتمندید. این پیشرفت را با جدیت ادامه دهید.",
            "آفرین [نام کاربر]! [روزهای پاک] روز پاکی، دستاوردی است که باید به آن افتخار کرد. از [تاریخ شروع]، شما به سوی یک زندگی سالم‌تر گام برداشته‌اید. با [تعداد وسوسه‌ها] چالش، شما قوی‌تر شده‌اید. این مسیر را با امید و شجاعت ادامه دهید.",
            "تبریک ویژه به [نام کاربر]! [روزهای پاک] روز، یک موفقیت فوق‌العاده است. از [تاریخ شروع]، شما نشان دادید که هیچ چیز غیرممکن نیست. با [تعداد وسوسه‌ها] وسوسه که از آن‌ها گذشتید، شما قوی‌تر شدید. به خودتان افتخار کنید.",
            "[نام کاربر] عزیز، [روزهای پاک] روز از این سفر شگفت‌انگیز می‌گذرد. [تاریخ شروع]، نقطه شروع شما به سوی آزادی بود. با [تعداد وسوسه‌ها] بار مقابله با وسوسه، شما به یک جنگجوی واقعی تبدیل شده‌اید. به این مسیر ادامه دهید.",
            "درود بر [نام کاربر]! [روزهای پاک] روز پاکی، نمادی از عزم و شجاعت شماست. از [تاریخ شروع]، شما ثابت کرده‌اید که می‌توانید زندگی‌تان را تغییر دهید. هرچند [تعداد وسوسه‌ها] بار با چالش روبرو شدید، اما هر بار با قدرت بیشتری بازگشتید.",
            "[نام کاربر]، شما در حال درخشش هستید! [روزهای پاک] روز از این مسیر پر نور می‌گذرد. از [تاریخ شروع]، شما هر روز بهتر از دیروز شده‌اید. با [تعداد وسوسه‌ها] وسوسه که با آن‌ها مقابله کردید، شما به خودتان اعتماد بیشتری پیدا کردید.",
            "تبریک به [نام کاربر]! [روزهای پاک] روز از این راه پر از دستاورد می‌گذرد. از [تاریخ شروع]، شما به سوی یک زندگی سالم و شادتر گام برداشته‌اید. با [تعداد وسوسه‌ها] بار غلبه بر وسوسه، شما الهام‌بخش دیگران هستید.",
            "[نام کاربر] عزیز، [روزهای پاک] روز از این سفر معنادار می‌گذرد. [تاریخ شروع]، روزی بود که شما به خودتان قول دادید. با [تعداد وسوسه‌ها] بار مقابله با وسوسه، شما به وعده خود عمل کرده‌اید. به این پیشرفت ادامه دهید.",
            "آفرین به [نام کاربر]! [روزهای پاک] روز پاکی، گواه اراده آهنین شماست. از [تاریخ شروع]، شما در حال ساختن یک آینده روشن هستید. هرچند [تعداد وسوسه‌ها] بار با چالش مواجه شدید، اما هر بار با تصمیم قوی‌تر به جلو رفتید.",
            "[نام کاربر]، شما یک نمونه عالی از پیروزی هستید! [روزهای پاک] روز از این مسیر هیجان‌انگیز می‌گذرد. از [تاریخ شروع]، شما هر روز بر خودتان مسلط‌تر شده‌اید. با [تعداد وسوسه‌ها] بار مقابله، شما به یک قهرمان تبدیل شده‌اید.",
            "تبریک به [نام کاربر]! [روزهای پاک] روز از این راه پر برکت می‌گذرد. [تاریخ شروع]، روزی بود که شما قدرتتان را کشف کردید. با [تعداد وسوسه‌ها] بار غلبه بر وسوسه، شما به خودتان ثابت کردید که بی‌نظیرید.",
            "آفرین [نام کاربر]! [روزهای پاک] روز پاکی، دستاوردی است که باید به آن افتخار کرد. از [تاریخ شروع]، شما هر روز به سوی اهدافتان نزدیک‌تر می‌شوید. با [تعداد وسوسه‌ها] چالش، شما هر روز قوی‌تر می‌شوید.",
            "[نام کاربر]، این [روزهای پاک] روز نشان از تعهد بی‌قید و شرط شماست. [تاریخ شروع]، نقطه‌ای بود که تصمیم گرفتید به سمت نور حرکت کنید. [تعداد وسوسه‌ها] وسوسه، نه مانع، که پله‌هایی برای صعودتان شدند.",
            "تبریک به [نام کاربر] عزیز! [روزهای پاک] روز از این سفر خودسازی می‌گذرد. از [تاریخ شروع]، هر قدم شما به سوی تکامل بوده است. با [تعداد وسوسه‌ها] بار مقابله، شما مهارت‌های جدیدی در خود کشف کرده‌اید.",
            "[نام کاربر] گرامی، [روزهای پاک] روز پاکی، نمادی از پیروزی اراده بر عادت است. [تاریخ شروع]، آغاز رهایی شما بود. هرچند [تعداد وسوسه‌ها] بار با وسوسه مواجه شدید، اما هر بار قوی‌تر شدید.",
            "آفرین بر [نام کاربر]! [روزهای پاک] روز از این راه پر از امید می‌گذرد. از [تاریخ شروع]، شما هر روز را با اراده‌ای تازه شروع کرده‌اید. [تعداد وسوسه‌ها] چالش، توانایی شما را در کنترل خویشتن ثابت کرده است.",
            "تبریک به [نام کاربر]! [روزهای پاک] روز از این مسیر پر از دستاورد می‌گذرد. از [تاریخ شروع]، شما ثابت کردید که می‌توانید به آرزوهایتان برسید. با [تعداد وسوسه‌ها] بار غلبه، شما به خودتان ثابت کردید که هیچ‌چیز غیرممکن نیست.",
            "[نام کاربر]، این [روزهای پاک] روز، یک داستان موفقیت است. [تاریخ شروع]، شروع یک زندگی جدید برای شما بود. [تعداد وسوسه‌ها] وسوسه، فرصت‌هایی برای قوی‌تر شدن شما بودند.",
            "درود بر [نام کاربر]! [روزهای پاک] روز پاکی، نشانه‌ای از رشد و تحول شماست. از [تاریخ شروع]، شما در حال تغییر زندگی‌تان هستید. [تعداد وسوسه‌ها] بار مقابله با وسوسه، نشان‌دهنده پشتکار شماست.",
            "[نام کاربر] عزیز، [روزهای پاک] روز از این راه پر عظمت می‌گذرد. [تاریخ شروع]، نقطه‌ای بود که شما تصمیم گرفتید بهتر زندگی کنید. با [تعداد وسوسه‌ها] چالش، شما به سوی یک آینده روشن‌تر حرکت می‌کنید.",
            "تبریک به [نام کاربر]! [روزهای پاک] روز از این مسیر پر از شجاعت می‌گذرد. از [تاریخ شروع] تا کنون، شما هر روز قوی‌تر شده‌اید. [تعداد وسوسه‌ها] بار غلبه بر وسوسه، شما را به قهرمان خودتان تبدیل کرده است.",
            "آفرین [نام کاربر]! [روزهای پاک] روز پاکی، دلیلی برای افتخار است. از [تاریخ شروع]، شما نشان دادید که به خودتان متعهد هستید. با [تعداد وسوسه‌ها] چالش، شما هر روز بهتر می‌شوید.",
            "[نام کاربر]، این [روزهای پاک] روز، گواه اراده بی‌نهایت شماست. [تاریخ شروع]، روزی بود که تصمیم گرفتید مسیر زندگی‌تان را تغییر دهید. [تعداد وسوسه‌ها] وسوسه، شما را قوی‌تر از قبل کرده است.",
            "تبریک به [نام کاربر] عزیز! [روزهای پاک] روز از این سفر تحول‌آفرین می‌گذرد. از [تاریخ شروع]، شما ثابت کردید که هیچ‌چیز نمی‌تواند اراده‌تان را بشکند. با [تعداد وسوسه‌ها] بار مقابله، شما الگوی دیگران شده‌اید.",
            "[نام کاربر] گرامی، [روزهای پاک] روز پاکی، یک دستاورد تاریخی است. [تاریخ شروع]، آغاز تولدی دوباره برای شما بود. هرچند [تعداد وسوسه‌ها] بار با وسوسه مواجه شدید، اما هر بار با عزم بیشتری بازگشتید.",
            "آفرین بر [نام کاربر]! [روزهای پاک] روز از این راه پر از پیروزی می‌گذرد. از [تاریخ شروع]، شما هر روز را با انرژی مضاعف شروع کرده‌اید. [تعداد وسوسه‌ها] چالش، نشان‌دهنده توانایی شما در غلبه بر سختی‌هاست.",
            "تبریک به [نام کاربر]! [روزهای پاک] روز از این مسیر پر از شکوه می‌گذرد. از [تاریخ شروع]، شما به سوی زندگی ایده‌آلتان حرکت کرده‌اید. با [تعداد وسوسه‌ها] بار غلبه، شما به خودتان ثابت کردید که می‌توانید هر چیزی را به دست آورید.",
            "[نام کاربر]، این [روزهای پاک] روز، نشانه‌ای از موفقیت بی‌پایان شماست. [تاریخ شروع]، شروع یک فصل جدید در زندگی‌تان بود. [تعداد وسوسه‌ها] وسوسه، فرصت‌هایی برای اثبات قدرتتان بودند.",
            "درود بر [نام کاربر]! [روزهای پاک] روز پاکی، گواه پایداری و خودکنترلی شماست. از [تاریخ شروع]، شما در حال تبدیل شدن به یک نسخه بهتر از خودتان هستید. [تعداد وسوسه‌ها] بار مقابله با وسوسه، نشان‌دهنده اراده شماست.",
            "[نام کاربر] عزیز، [روزهای پاک] روز از این راه پر افتخار می‌گذرد. [تاریخ شروع]، نقطه‌ای بود که شما تصمیم گرفتید آزاد زندگی کنید. با [تعداد وسوسه‌ها] چالش، شما هر روز قوی‌تر می‌شوید.",
            "تبریک به [نام کاربر]! [روزهای پاک] روز از این مسیر پر از امید می‌گذرد. از [تاریخ شروع] تا کنون، شما هر روز بهتر شده‌اید. [تعداد وسوسه‌ها] بار غلبه بر وسوسه، شما را به سوی موفقیت سوق می‌دهد.",
            "آفرین [نام کاربر]! [روزهای پاک] روز پاکی، دلیلی برای الهام‌بخشی است. از [تاریخ شروع]، شما نشان دادید که به آینده‌ای بهتر ایمان دارید. با [تعداد وسوسه‌ها] چالش، شما هر روز به هدفتان نزدیک‌تر می‌شوید.",
            "تبریک به [نام کاربر]! [روزهای پاک] روز از این مسیر شگفت‌انگیز می‌گذرد. [تاریخ شروع]، لحظه‌ای بود که شما قدرت خود را بازیافتید. با [تعداد وسوسه‌ها] بار مقابله با وسوسه، شما به یک قهرمان تبدیل شده‌اید.",
            "[نام کاربر] عزیز، [روزهای پاک] روز از این سفر معنادار می‌گذرد. [تاریخ شروع]، آغاز تغییرات مثبت در زندگی شما بود. با [تعداد وسوسه‌ها] وسوسه که با آن‌ها روبرو شدید، شما به خودتان ثابت کردید که می‌توانید.",
            "درود بر [نام کاربر]! [روزهای پاک] روز پاکی، نمادی از خودباوری و استقامت است. از [تاریخ شروع]، شما در حال ساختن یک داستان موفقیت هستید. [تعداد وسوسه‌ها] بار مقابله با وسوسه، نشان‌دهنده اراده شماست.",
            "[نام کاربر]، شما در حال ساختن یک میراث هستید! [روزهای پاک] روز از این مسیر پر افتخار می‌گذرد. از [تاریخ شروع]، شما هر روز به سوی بهترین نسخه از خودتان پیش می‌روید. با [تعداد وسوسه‌ها] چالش، شما قوی‌تر می‌شوید.",
            "تبریک به [نام کاربر]! [روزهای پاک] روز از این راه پر برکت می‌گذرد. [تاریخ شروع]، روزی بود که شما آزادی را انتخاب کردید. با [تعداد وسوسه‌ها] بار غلبه بر وسوسه، شما به سوی زندگی ایده‌آلتان حرکت می‌کنید.",
            "[نام کاربر] عزیز، [روزهای پاک] روز از این سفر هیجان‌انگیز می‌گذرد. [تاریخ شروع]، آغاز یک زندگی بدون محدودیت برای شما بود. با [تعداد وسوسه‌ها] بار مقابله با وسوسه، شما به خودتان ثابت کردید که توانا هستید.",
            "آفرین [نام کاربر]! [روزهای پاک] روز پاکی، دلیلی برای جشن گرفتن و افتخار است. از [تاریخ شروع]، شما نشان دادید که به اهدافتان پایبندید. با [تعداد وسوسه‌ها] چالش، شما هر روز بهتر و قوی‌تر می‌شوید.",
            "[نام کاربر]، این [روزهای پاک] روز، نشانه‌ای از قدرت و اراده بی‌حد و حصر شماست. [تاریخ شروع]، روزی بود که تصمیم گرفتید سرنوشتتان را تغییر دهید. [تعداد وسوسه‌ها] وسوسه، تنها نقاط عطفی در مسیر پیروزی شما بودند.",
            "تبریک به [نام کاربر] عزیز! [روزهای پاک] روز از این مسیر روشن می‌گذرد. از [تاریخ شروع]، شما ثابت کردید که می‌توانید بر هر مانعی غلبه کنید. با [تعداد وسوسه‌ها] بار مقابله، شما یک الگو برای دیگران شده‌اید.",
            "[نام کاربر] گرامی، [روزهای پاک] روز پاکی، یک دستاورد بی‌نظیر است. [تاریخ شروع]، آغاز یک زندگی جدید و پر از فرصت برای شما بود. هرچند [تعداد وسوسه‌ها] بار با وسوسه مواجه شدید، اما هر بار با انرژی بیشتری بازگشتید."
        ];

        const formatDate = (date) => {
            if (!date) return '';
            const year = date.getFullYear();
            const month = (date.getMonth() + 1).toString().padStart(2, '0');
            const day = date.getDate().toString().padStart(2, '0');
            return `${year}/${month}/${day}`;
        };

        const isSameDay = (d1, d2) => {
            if (!d1 || !d2) return false;
            return d1.getFullYear() === d2.getFullYear() &&
                   d1.getMonth() === d2.getMonth() &&
                   d1.getDate() === d2.getDate();
        };

        const Snackbar = ({ message, show }) => {
            return (
                <div className={`snackbar ${show ? 'show' : ''}`}>
                    {message}
                </div>
            );
        };

        const useSnackbar = () => {
            const [snackbarMessage, setSnackbarMessage] = useState('');
            const [showSnackbarState, setShowSnackbarState] = useState(false); 
            const snackbarTimerRef = useRef(null);

            const show = (message, duration = 3000) => {
                if (snackbarTimerRef.current) {
                    clearTimeout(snackbarTimerRef.current);
                }
                setSnackbarMessage(message);
                setShowSnackbarState(true);
                snackbarTimerRef.current = setTimeout(() => {
                    setShowSnackbarState(false);
                    setSnackbarMessage('');
                }, duration);
            };

            return { snackbarMessage, showSnackbar: showSnackbarState, show }; 
        };

        function SplashScreen({ onFinish }) {
            const [fadeOut, setFadeOut] = useState(false);

            useEffect(() => {
                const timer = setTimeout(() => {
                    setFadeOut(true);
                    const hideTimer = setTimeout(onFinish, 1000); 
                    return () => clearTimeout(hideTimer);
                }, 2000); 
                return () => clearTimeout(timer);
            }, [onFinish]);

            return (
                <div className={`splash-screen ${fadeOut ? 'fade-out' : ''}`}>
                    <i className="fas fa-heartbeat text-8xl mb-6 text-white dark:text-blue-300"></i>
                    <h1 className="text-5xl font-extrabold text-white mb-4">SafeMind</h1>
                    <p className="text-xl text-white">سفر شما به سوی آزادی آغاز می‌شود...</p>
                    <div className="mt-8">
                        <i className="fas fa-spinner fa-spin text-4xl text-white"></i>
                    </div>
                </div>
            );
        }

        function RelapseConfirmationModal({ onConfirm, onCancel }) {
            return (
                <div className="modal-overlay">
                    <div className="modal-content text-gray-800 dark:text-gray-200">
                        <h3 className="text-xl sm:text-2xl font-bold mb-6">آیا شما لغزش داشته اید ؟</h3>
                        <div className="flex justify-center gap-3 sm:gap-4">
                            <button
                                onClick={onConfirm}
                                className="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 sm:px-6 rounded-lg transition duration-300 text-sm sm:text-base"
                            >
                                بله
                            </button>
                            <button
                                onClick={onCancel}
                                className="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 sm:px-6 rounded-lg transition duration-300 text-sm sm:text-base"
                            >
                                خیر
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

        function UserNamePrompt({ onSaveName }) {
            const [name, setName] = useState('');

            const handleSave = () => {
                if (name.trim()) {
                    onSaveName(name.trim());
                }
            };

            return (
                <div className="modal-overlay">
                    <div className="modal-content text-gray-800 dark:text-gray-200">
                        <h3 className="text-xl sm:text-2xl font-bold mb-6">به SafeMind خوش آمدید!</h3>
                        <p className="text-base sm:text-lg mb-4">لطفاً نام خود را وارد کنید تا سفرتان را شخصی‌سازی کنیم:</p>
                        <input
                            type="text"
                            className="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white mb-6 text-center text-sm sm:text-base"
                            placeholder="نام شما"
                            value={name}
                            onChange={(e) => setName(e.target.value)}
                            onKeyPress={(e) => { if (e.key === 'Enter') handleSave(); }}
                        />
                        <button
                            onClick={handleSave}
                            className="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg transition duration-300 text-sm sm:text-base"
                        >
                            شروع سفر
                        </button>
                    </div>
                </div>
            );
        }

        function HomeScreen({ showSnackbar, userName }) {
            const [cleanDays, setCleanDays] = useState(0);
            const [lastCheckInDate, setLastCheckInDate] = useState(null);
            const [dailyRecords, setDailyRecords] = useState([]);
            const [isTodayCheckedIn, setIsTodayCheckedIn] = useState(false);
            const [dailyUniqueEffects, setDailyUniqueEffects] = useState([]);

            useEffect(() => {
                const storedCleanDays = localStorage.getItem('safemind_clean_days');
                const storedLastCheckInDate = localStorage.getItem('safemind_last_check_in_date');
                const storedDailyRecords = localStorage.getItem('safemind_daily_records');

                if (storedCleanDays) {
                    setCleanDays(parseInt(storedCleanDays, 10));
                }
                if (storedLastCheckInDate) {
                    const date = new Date(storedLastCheckInDate);
                    setLastCheckInDate(date);
                    setIsTodayCheckedIn(isSameDay(date, new Date()));
                }
                if (storedDailyRecords) {
                    setDailyRecords(JSON.parse(storedDailyRecords).map(dateStr => new Date(dateStr)));
                }

                if (parseInt(storedCleanDays, 10) > 0 && parseInt(storedCleanDays, 10) <= 90) {
                    setDailyUniqueEffects(daily90DayEffects[parseInt(storedCleanDays, 10) - 1]);
                } else if (parseInt(storedCleanDays, 10) === 0) {
                    setDailyUniqueEffects([]); 
                } else {
                    setDailyUniqueEffects(daily90DayEffects[89]); 
                }
            }, []);

            useEffect(() => {
                localStorage.setItem('safemind_clean_days', cleanDays.toString());
                localStorage.setItem('safemind_last_check_in_date', lastCheckInDate ? lastCheckInDate.toISOString() : '');
                localStorage.setItem('safemind_daily_records', JSON.stringify(dailyRecords.map(date => date.toISOString())));
            }, [cleanDays, lastCheckInDate, dailyRecords]);

            const handleCheckIn = () => {
                const today = new Date();
                if (isSameDay(lastCheckInDate, today)) {
                    showSnackbar('شما قبلاً امروز را ثبت کرده‌اید.');
                    return;
                }

                const newDailyRecords = [...dailyRecords, today];
                setDailyRecords(newDailyRecords);
                setCleanDays(newDailyRecords.length); 
                setLastCheckInDate(today);
                setIsTodayCheckedIn(true);
                showSnackbar('تبریک! امروز هم پاک هستید.');

                if (newDailyRecords.length > 0 && newDailyRecords.length <= 90) {
                    setDailyUniqueEffects(daily90DayEffects[newDailyRecords.length - 1]);
                } else if (newDailyRecords.length > 90) {
                    setDailyUniqueEffects(daily90DayEffects[89]); 
                }
            };

            const todayFormatted = formatDate(new Date());
            const progressPercentage = Math.min((cleanDays / 90) * 100, 100);

            const radius = 44;
            const circumference = 2 * Math.PI * radius;
            const strokeDashoffset = circumference - (progressPercentage / 100) * circumference;

            return (
                <div className="text-center p-4 sm:p-6 flex flex-col items-center">
                    <div className="w-full bg-gradient-to-r from-blue-600 to-blue-400 text-white p-6 rounded-xl shadow-lg mb-6 sm:mb-8">
                        <h2 className="text-2xl sm:text-3xl font-extrabold mb-2">
                            {userName ? `خوش آمدید، ${userName}!` : 'به SafeMind خوش آمدید!'}
                        </h2>
                        <p className="text-lg sm:text-xl">
                            سفر شما به سوی آزادی از همین امروز آغاز می‌شود.
                        </p>
                    </div>

                    <p className="text-base sm:text-lg text-gray-700 dark:text-gray-300 mb-6 sm:mb-8">
                        امروز: {todayFormatted}
                    </p>

                    <div className="clean-days-box relative w-48 h-48 sm:w-64 sm:h-64 rounded-full border-2 flex flex-col items-center justify-center mx-auto mb-8 sm:mb-10 transform transition-transform duration-300 hover:scale-105 overflow-hidden">
                        <div className="absolute inset-0 bg-gradient-to-br from-blue-100 to-blue-300 dark:from-gray-700 dark:to-gray-800 opacity-20 rounded-full"></div>
                        <svg className="absolute inset-0 w-full h-full" viewBox="0 0 100 100">
                            <circle
                                className="text-gray-200 dark:text-gray-700"
                                strokeWidth="8"
                                stroke="currentColor"
                                fill="transparent"
                                r="44"
                                cx="50"
                                cy="50"
                            />
                            <circle
                                className="text-blue-500"
                                strokeWidth="8"
                                strokeDasharray={circumference}
                                strokeDashoffset={strokeDashoffset}
                                strokeLinecap="round"
                                stroke="currentColor"
                                fill="transparent"
                                r="44"
                                cx="50"
                                cy="50"
                                style={{ transition: 'stroke-dashoffset 0.5s ease-out' }}
                                transform="rotate(-90 50 50)"
                            />
                        </svg>
                        <div className="relative z-10 text-center">
                            <h2 className="text-xl sm:text-2xl font-extrabold text-blue-700 dark:text-blue-300">
                                روزهای پاک:
                            </h2>
                            <p className="text-5xl sm:text-6xl font-extrabold text-blue-800 dark:text-blue-200 mt-1 sm:mt-2 leading-none">
                                {cleanDays}
                            </p>
                            <p className="text-xl sm:text-2xl font-semibold text-blue-600 dark:text-blue-400 mt-1">
                                از ۹۰ روز
                            </p>
                            <p className="text-sm sm:text-base font-bold text-blue-700 dark:text-blue-300 mt-2">
                                {progressPercentage.toFixed(0)}%
                            </p>
                        </div>
                    </div>

                    <button
                        onClick={handleCheckIn}
                        disabled={isTodayCheckedIn}
                        className={`flex items-center justify-center mx-auto px-6 py-3 sm:px-8 sm:py-4 rounded-full text-white font-bold text-lg sm:text-2xl transition duration-300 ease-in-out transform hover:scale-105 w-full max-w-[280px] sm:max-w-xs shadow-lg hover:shadow-xl
                            ${isTodayCheckedIn ? 'bg-green-500 text-white cursor-not-allowed' : 'bg-blue-600 hover:bg-blue-700'}
                        `}
                    >
                        {isTodayCheckedIn ? (
                            <>
                                <i className="fas fa-check-circle ml-2 text-xl sm:text-3xl"></i>
                                امروز ثبت شد!
                            </>
                        ) : (
                            <>
                                <i className="fas fa-hand-holding-heart ml-2 text-xl sm:text-3xl"></i>
                                من امروز پاک هستم
                            </>
                        )}
                    </button>

                    <div className="mt-8 sm:mt-10 p-4 sm:p-6 bg-blue-50 dark:bg-gray-800 rounded-xl shadow-md w-full max-w-md mx-auto border border-blue-200 dark:border-gray-700">
                        <h3 className="text-xl sm:text-2xl font-bold text-blue-700 dark:text-blue-300 mb-3 sm:mb-4">اثرات مثبت امروز:</h3>
                        {dailyUniqueEffects.length > 0 ? (
                            <ul className="space-y-2 sm:space-y-3 text-right">
                                {dailyUniqueEffects.map((effect, index) => (
                                    <li key={index} className="flex items-center text-gray-800 dark:text-gray-200 text-sm sm:text-lg">
                                        <i className="fas fa-check-circle text-green-500 ml-2 sm:ml-3"></i>
                                        {effect}
                                    </li>
                                ))}
                            </ul>
                        ) : (
                            <p className="text-gray-600 dark:text-gray-400 text-sm sm:text-base">هنوز اثری برای نمایش وجود ندارد. با ثبت روزهای پاک، اثرات هر روز را مشاهده خواهید کرد.</p>
                        )}
                    </div>
                </div>
            );
        }

        function MotivationalMessagesScreen({ showSnackbar }) {
            const [messages, setMessages] = useState(() => {
                const storedMessages = localStorage.getItem('safemind_messages');
                return storedMessages ? JSON.parse(storedMessages) : motivationalMessages.slice(0, 5);
            });
            const [newMessage, setNewMessage] = useState('');
            const [dailyMessage, setDailyMessage] = useState('');
            const [lastMessageDate, setLastMessageDate] = useState(null);

            useEffect(() => {
                localStorage.setItem('safemind_messages', JSON.stringify(messages));
                displayDailyMessage(); 
            }, [messages]);

            useEffect(() => {
                const storedLastMessageDate = localStorage.getItem('safemind_last_message_date');
                if (storedLastMessageDate) {
                    setLastMessageDate(new Date(storedLastMessageDate));
                }
                displayDailyMessage(); 
            }, []); 

            const displayDailyMessage = () => {
                const today = new Date();
                if ((!isSameDay(lastMessageDate, today) || !dailyMessage) && messages.length > 0) {
                    const randomIndex = Math.floor(Math.random() * messages.length);
                    setDailyMessage(messages[randomIndex]);
                    setLastMessageDate(today);
                    localStorage.setItem('safemind_last_message_date', today.toISOString());
                } else if (messages.length === 0) {
                    setDailyMessage('پیامی برای نمایش وجود ندارد. یکی اضافه کنید!');
                }
            };

            const handleAddMessage = () => {
                if (newMessage.trim()) {
                    setMessages([...messages, newMessage.trim()]);
                    setNewMessage('');
                    showSnackbar('پیام انگیزشی اضافه شد!');
                }
            };

            const handleDeleteMessage = (indexToDelete) => {
                const updatedMessages = messages.filter((_, index) => index !== indexToDelete);
                setMessages(updatedMessages);
                showSnackbar('پیام حذف شد!');
            };

            const generateNewMessage = () => {
                if (motivationalMessages.length > 0) {
                    const randomIndex = Math.floor(Math.random() * motivationalMessages.length);
                    setDailyMessage(motivationalMessages[randomIndex]);
                    showSnackbar('پیام جدید تولید شد!');
                } else {
                    showSnackbar('متن‌های آماده برای تولید پیام موجود نیست.');
                }
            };

            return (
                <div className="text-center p-2">
                    <h2 className="text-2xl sm:text-3xl font-extrabold text-blue-700 dark:text-blue-300 mb-4 sm:mb-6">پیام انگیزشی روز</h2>
                    <div className="card p-4 sm:p-6 rounded-xl shadow-md mb-4 min-h-[80px] sm:min-h-[100px] flex items-center justify-center">
                        <p className="text-lg sm:text-xl font-semibold text-gray-800 dark:text-gray-200 leading-relaxed">
                            "{dailyMessage || (messages.length > 0 ? "در حال بارگذاری پیام..." : "پیامی برای نمایش وجود ندارد.")}"
                        </p>
                    </div>
                    <button
                        onClick={generateNewMessage}
                        className="bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-full transition duration-300 ease-in-out transform hover:scale-105 mb-6 sm:mb-8 flex items-center justify-center mx-auto text-sm sm:text-base">
                        <i className="fas fa-magic ml-2"></i>
                        تولید پیام جدید ✨
                    </button>

                    <h3 className="text-xl sm:text-2xl font-bold text-gray-800 dark:text-gray-200 mb-3 sm:mb-4">پیام‌های شما</h3>
                    <div className="mb-4 sm:mb-6 flex flex-col sm:flex-row gap-2 sm:gap-4">
                        <input
                            type="text"
                            className="flex-grow p-2 sm:p-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white text-sm sm:text-base"
                            placeholder="یک پیام جدید اضافه کنید..."
                            value={newMessage}
                            onChange={(e) => setNewMessage(e.target.value)}
                            onKeyPress={(e) => { if (e.key === 'Enter') handleAddMessage(); }}
                        />
                        <button
                            onClick={handleAddMessage}
                            className="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 sm:py-3 sm:px-6 rounded-lg transition duration-300 ease-in-out transform hover:scale-105 flex-shrink-0 text-sm sm:text-base">
                            <i className="fas fa-plus ml-1 sm:ml-2"></i>
                            افزودن
                        </button>
                    </div>

                    <ul className="space-y-2 sm:space-y-3 max-h-48 sm:max-h-60 overflow-y-auto p-2 border border-gray-200 dark:border-gray-700 rounded-lg">
                        {messages.length === 0 && <li className="text-gray-600 dark:text-gray-400 text-sm sm:text-base">هنوز پیامی اضافه نشده است.</li>}
                        {messages.map((msg, index) => (
                            <li key={index} className="flex items-center justify-between bg-gray-50 dark:bg-gray-700 p-2 sm:p-3 rounded-md shadow-sm">
                                <span className="text-gray-800 dark:text-gray-200 text-xs sm:text-base">{msg}</span>
                                <button
                                    onClick={() => handleDeleteMessage(index)}
                                    className="text-red-500 hover:text-red-700 transition duration-200 p-1"
                                >
                                    <i className="fas fa-trash-alt text-sm sm:text-base"></i>
                                </button>
                            </li>
                        ))}
                    </ul>
                </div>
            );
        }

        function PositiveEffectsScreen({ showSnackbar }) {
            const [effects, setEffects] = useState(() => {
                const storedEffects = localStorage.getItem('safemind_effects');
                return storedEffects ? JSON.parse(storedEffects) : [];
            });
            const [newEffect, setNewEffect] = useState('');
            const [dailyEffect, setDailyEffect] = useState('');
            const [lastEffectDate, setLastEffectDate] = useState(null);

            useEffect(() => {
                localStorage.setItem('safemind_effects', JSON.stringify(effects));
                displayDailyEffect(); 
            }, [effects]);

            useEffect(() => {
                const storedLastEffectDate = localStorage.getItem('safemind_last_effect_date'); 
                if (storedLastEffectDate) {
                    setLastEffectDate(new Date(storedLastEffectDate));
                }
                displayDailyEffect(); 
            }, []); 

            const displayDailyEffect = () => {
                const today = new Date();
                if ((!isSameDay(lastEffectDate, today) || !dailyEffect) && effects.length > 0) {
                    const randomIndex = Math.floor(Math.random() * effects.length);
                    setDailyEffect(effects[randomIndex]);
                    setLastEffectDate(today);
                    localStorage.setItem('safemind_last_effect_date', today.toISOString()); 
                } else if (effects.length === 0) {
                    setDailyEffect('اثری برای نمایش وجود ندارد. یکی اضافه کنید!');
                }
            };

            const handleAddEffect = () => {
                if (newEffect.trim()) {
                    setEffects([...effects, newEffect.trim()]);
                    setNewEffect('');
                    showSnackbar('اثر مثبت اضافه شد!');
                }
            };

            const handleDeleteEffect = (indexToDelete) => {
                const updatedEffects = effects.filter((_, index) => index !== indexToDelete);
                setEffects(updatedEffects);
                showSnackbar('اثر مثبت حذف شد!');
            };

            return (
                <div className="text-center p-2">
                    <h2 className="text-2xl sm:text-3xl font-extrabold text-blue-700 dark:text-blue-300 mb-4 sm:mb-6">اثر مثبت روز</h2>
                    <div className="card p-4 sm:p-6 rounded-xl shadow-md mb-3 sm:mb-4 min-h-[80px] sm:min-h-[100px] flex items-center justify-center">
                        <p className="text-lg sm:text-xl font-semibold text-gray-800 dark:text-gray-200 leading-relaxed">
                             "{dailyEffect || (effects.length > 0 ? "در حال بارگذاری اثر..." : "اثری برای نمایش وجود ندارد.")}"
                        </p>
                    </div>

                    <h3 className="text-xl sm:text-2xl font-bold text-gray-800 dark:text-gray-200 mb-3 sm:mb-4">اثرات مثبت شما</h3>
                    <div className="mb-4 sm:mb-6 flex flex-col sm:flex-row gap-2 sm:gap-4">
                        <input
                            type="text"
                            className="flex-grow p-2 sm:p-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white text-sm sm:text-base"
                            placeholder="یک اثر مثبت جدید اضافه کنید..."
                            value={newEffect}
                            onChange={(e) => setNewEffect(e.target.value)}
                            onKeyPress={(e) => { if (e.key === 'Enter') handleAddEffect(); }}
                        />
                        <button
                            onClick={handleAddEffect}
                            className="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 sm:py-3 sm:px-6 rounded-lg transition duration-300 ease-in-out transform hover:scale-105 flex-shrink-0 text-sm sm:text-base">
                            <i className="fas fa-plus ml-1 sm:ml-2"></i>
                            افزودن
                        </button>
                    </div>

                    <ul className="space-y-2 sm:space-y-3 max-h-48 sm:max-h-60 overflow-y-auto p-2 border border-gray-200 dark:border-gray-700 rounded-lg">
                        {effects.length === 0 && <li className="text-gray-600 dark:text-gray-400 text-sm sm:text-base">هنوز اثری اضافه نشده است.</li>}
                        {effects.map((effect, index) => (
                            <li key={index} className="flex items-center justify-between bg-gray-50 dark:bg-gray-700 p-2 sm:p-3 rounded-md shadow-sm">
                                <span className="text-gray-800 dark:text-gray-200 text-xs sm:text-base">{effect}</span>
                                <button
                                    onClick={() => handleDeleteEffect(index)}
                                    className="text-red-500 hover:text-red-700 transition duration-200 p-1"
                                >
                                    <i className="fas fa-trash-alt text-sm sm:text-base"></i>
                                </button>
                            </li>
                        ))}
                    </ul>
                </div>
            );
        }

        function ReasonsWallScreen({ showSnackbar }) {
            const [reasons, setReasons] = useState(() => {
                const storedReasons = localStorage.getItem('safemind_reasons');
                return storedReasons ? JSON.parse(storedReasons) : reasonsToQuit.slice(0, 3);
            });
            const [newReason, setNewReason] = useState('');
            const [displayReason, setDisplayReason] = useState('');

            useEffect(() => { localStorage.setItem('safemind_reasons', JSON.stringify(reasons)); }, [reasons]);
            
            useEffect(() => {
                if (reasonsToQuit.length > 0) {
                    const randomIndex = Math.floor(Math.random() * reasonsToQuit.length);
                    setDisplayReason(reasonsToQuit[randomIndex]);
                }
            }, []);

            const handleAddReason = () => {
                if (newReason.trim()) {
                    setReasons([...reasons, newReason.trim()]);
                    setNewReason('');
                    showSnackbar('دلیل جدید اضافه شد!');
                }
            };
            const handleDeleteReason = (indexToDelete) => setReasons(reasons.filter((_, index) => index !== indexToDelete));

            const generateNewReason = () => {
                if (reasonsToQuit.length > 0) {
                    const randomIndex = Math.floor(Math.random() * reasonsToQuit.length);
                    setDisplayReason(reasonsToQuit[randomIndex]);
                    showSnackbar('دلیل جدید تولید شد!');
                } else {
                    showSnackbar('متن‌های آماده برای تولید دلیل موجود نیست.');
                }
            };

             return (
                <div className="text-center p-2">
                    <h2 className="text-2xl sm:text-3xl font-extrabold text-blue-700 dark:text-blue-300 mb-4 sm:mb-6">دیوار دلایل ترک</h2>
                    <div className="card p-4 sm:p-6 rounded-xl shadow-md mb-3 sm:mb-4 min-h-[80px] sm:min-h-[100px] flex items-center justify-center">
                        <p className="text-lg sm:text-xl font-semibold text-gray-800 dark:text-gray-200 leading-relaxed">
                            "{displayReason || "یک دلیل جدید تولید کنید یا از لیست خود انتخاب کنید!"}"
                        </p>
                    </div>
                    <button
                        onClick={generateNewReason}
                        className="bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-full transition duration-300 ease-in-out transform hover:scale-105 mb-6 sm:mb-8 flex items-center justify-center mx-auto text-sm sm:text-base">
                        <i className="fas fa-lightbulb ml-2"></i>
                        تولید دلیل جدید ✨
                    </button>
                    <h3 className="text-xl sm:text-2xl font-bold text-gray-800 dark:text-gray-200 mb-3 sm:mb-4">دلایل شما</h3>
                    <div className="mb-4 sm:mb-6 flex flex-col sm:flex-row gap-2 sm:gap-4">
                        <input type="text" className="flex-grow p-2 sm:p-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white text-sm sm:text-base" placeholder="یک دلیل جدید اضافه کنید..." value={newReason} onChange={(e) => setNewReason(e.target.value)} onKeyPress={(e) => { if (e.key === 'Enter') handleAddReason(); }} />
                        <button onClick={handleAddReason} className="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 sm:py-3 sm:px-6 rounded-lg transition duration-300 ease-in-out transform hover:scale-105 flex-shrink-0 text-sm sm:text-base">
                            <i className="fas fa-plus ml-1 sm:ml-2"></i> افزودن
                        </button>
                    </div>
                    <ul className="space-y-2 sm:space-y-3 max-h-48 sm:max-h-60 overflow-y-auto p-2 border border-gray-200 dark:border-gray-700 rounded-lg">
                        {reasons.length === 0 && <li className="text-gray-600 dark:text-gray-400 text-sm sm:text-base">هنوز دلیلی اضافه نشده است.</li>}
                        {reasons.map((reason, index) => (
                            <li key={index} className="flex items-center justify-between bg-gray-50 dark:bg-gray-700 p-2 sm:p-3 rounded-md shadow-sm">
                                <span className="text-gray-800 dark:text-gray-200 text-xs sm:text-base">{reason}</span>
                                <button
                                    onClick={() => handleDeleteReason(index)}
                                    className="text-red-500 hover:text-red-700 transition duration-200 p-1"
                                >
                                    <i className="fas fa-trash-alt text-sm sm:text-base"></i>
                                </button>
                            </li>
                        ))}
                    </ul>
                </div>
            );
        }


        function TemptationStatsScreen({ showSnackbar }) {
            const [temptations, setTemptations] = useState(() => {
                const storedTemptations = localStorage.getItem('safemind_temptations');
                return storedTemptations ? JSON.parse(storedTemptations).map(t => ({ ...t, date: new Date(t.date) })) : [];
            });
            const [tempDescription, setTempDescription] = useState('');
            const [analysisResult, setAnalysisResult] = useState('');

            useEffect(() => { localStorage.setItem('safemind_temptations', JSON.stringify(temptations.map(t => ({ ...t, date: t.date.toISOString() })))); }, [temptations]);

            const handleAddTemptation = () => {
                if (tempDescription.trim()) {
                    setTemptations([...temptations, { id: Date.now(), date: new Date(), description: tempDescription.trim() }]);
                    setTempDescription('');
                    showSnackbar('وسوسه ثبت شد!');
                }
            };
            const handleDeleteTemptation = (idToDelete) => setTemptations(temptations.filter(t => t.id !== idToDelete));

            const analyzeTemptations = () => {
                if (analyzeTemptationStrategies.length > 0) {
                    const randomIndex = Math.floor(Math.random() * analyzeTemptationStrategies.length);
                    setAnalysisResult(analyzeTemptationStrategies[randomIndex]);
                    showSnackbar('تحلیل با موفقیت انجام شد!');
                } else {
                    showSnackbar('متن‌های آماده برای تحلیل وسوسه موجود نیست.');
                }
            };
            return (
                 <div className="text-center p-2">
                    <h2 className="text-2xl sm:text-3xl font-extrabold text-blue-700 dark:text-blue-300 mb-4 sm:mb-6">آمار و تحلیل وسوسه</h2>
                    <h3 className="text-xl sm:text-2xl font-bold text-gray-800 dark:text-gray-200 mb-3 sm:mb-4">ثبت وسوسه</h3>
                    <div className="mb-4 sm:mb-6 flex flex-col sm:flex-row gap-2 sm:gap-4">
                        <input type="text" className="flex-grow p-2 sm:p-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white text-sm sm:text-base" placeholder="توضیح کوتاهی از وسوسه..." value={tempDescription} onChange={(e) => setTempDescription(e.target.value)} onKeyPress={(e) => { if (e.key === 'Enter') handleAddTemptation(); }} />
                        <button onClick={handleAddTemptation} className="bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-4 sm:py-3 sm:px-6 rounded-lg transition duration-300 ease-in-out transform hover:scale-105 flex-shrink-0 text-sm sm:text-base">
                            <i className="fas fa-plus ml-1 sm:ml-2"></i> ثبت وسوسه
                        </button>
                    </div>
                    <ul className="space-y-2 sm:space-y-3 max-h-48 sm:max-h-60 overflow-y-auto p-2 border border-gray-200 dark:border-gray-700 rounded-lg mb-6 sm:mb-8">
                        {temptations.length === 0 && <li className="text-gray-600 dark:text-gray-400 text-sm sm:text-base">هنوز وسوسه‌ای ثبت نشده است.</li>}
                        {temptations.map((temp) => (
                            <li key={temp.id} className="flex items-center justify-between bg-gray-50 dark:bg-gray-700 p-2 sm:p-3 rounded-md shadow-sm">
                                <span className="text-gray-800 dark:text-gray-200 text-xs sm:text-base">{temp.description} ({formatDate(temp.date)})</span>
                                <button
                                    onClick={() => handleDeleteTemptation(temp.id)}
                                    className="text-red-500 hover:text-red-700 transition duration-200 p-1"
                                >
                                    <i className="fas fa-trash-alt text-sm sm:text-base"></i>
                                </button>
                            </li>
                        ))}
                    </ul>
                    <button onClick={analyzeTemptations} disabled={temptations.length === 0} className="bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-full transition duration-300 ease-in-out transform hover:scale-105 mb-6 sm:mb-8 flex items-center justify-center mx-auto text-sm sm:text-base">
                        <i className="fas fa-brain ml-2"></i>
                        تحلیل وسوسه‌ها و پیشنهاد راهکار ✨
                    </button>
                    {analysisResult && (
                        <div className="card p-4 sm:p-6 rounded-xl shadow-md mt-4 sm:mt-6 text-left">
                            <h3 className="text-lg sm:text-xl font-bold mb-2 sm:mb-3 text-blue-700 dark:text-blue-300">نتیجه تحلیل:</h3>
                            <p className="text-gray-800 dark:text-gray-200 whitespace-pre-wrap text-sm sm:text-base">{analysisResult}</p>
                        </div>
                    )}
                </div>
            );
        }

        function ProfileScreen({ showSnackbar, userName }) {
            const [cleanDays, setCleanDays] = useState(0);
            const [startDate, setStartDate] = useState(null);
            const [dailyRecords, setDailyRecords] = useState([]);
            const [temptations, setTemptations] = useState([]);
            const [progressReport, setProgressReport] = useState('');

            useEffect(() => {
                setCleanDays(parseInt(localStorage.getItem('safemind_clean_days') || '0', 10));
                const storedDailyRecords = localStorage.getItem('safemind_daily_records');
                if (storedDailyRecords) {
                    const records = JSON.parse(storedDailyRecords).map(dateStr => new Date(dateStr));
                    setDailyRecords(records);
                    if (records.length > 0) { records.sort((a,b) => a-b); setStartDate(records[0]); }
                }
                const storedTemptations = localStorage.getItem('safemind_temptations');
                if (storedTemptations) setTemptations(JSON.parse(storedTemptations).map(t => ({ ...t, date: new Date(t.date) })));
            }, []);

            const generateProgressReport = () => {
                const reportIndex = Math.floor(Math.random() * progressReports.length);
                let reportText = progressReports[reportIndex];
                reportText = reportText.replace('[نام کاربر]', userName || 'کاربر');
                reportText = reportText.replace('[روزهای پاک]', cleanDays.toString());
                reportText = reportText.replace('[تاریخ شروع]', startDate ? formatDate(startDate) : 'مشخص نیست');
                reportText = reportText.replace('[تعداد وسوسه‌ها]', temptations.length.toString());
                setProgressReport(reportText);
                showSnackbar('گزارش با موفقیت تولید شد!');
            };
            return (
                <div className="text-center p-2">
                    <h2 className="text-2xl sm:text-3xl font-extrabold text-blue-700 dark:text-blue-300 mb-4 sm:mb-6">پروفایل و تاریخچه</h2>
                    <div className="card p-4 sm:p-6 rounded-xl shadow-md mb-4 sm:mb-6 text-left text-sm sm:text-base">
                        <p className="font-semibold mb-1 sm:mb-2 text-gray-800 dark:text-gray-200">نام کاربری: <span className="text-blue-600 dark:text-blue-400">{userName || 'مهمان'}</span></p>
                        <p className="font-semibold mb-1 sm:mb-2 text-gray-800 dark:text-gray-200">روزهای پاک: <span className="text-blue-600 dark:text-blue-400">{cleanDays}</span></p>
                        <p className="font-semibold mb-1 sm:mb-2 text-gray-800 dark:text-gray-200">تاریخ شروع: {startDate ? formatDate(startDate) : 'هنوز ثبت نشده'}</p>
                        <p className="font-semibold text-gray-800 dark:text-gray-200">تعداد وسوسه‌های ثبت شده: {temptations.length}</p>
                    </div>
                    <button onClick={generateProgressReport} className="bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-full transition duration-300 ease-in-out transform hover:scale-105 mb-6 sm:mb-8 flex items-center justify-center mx-auto text-sm sm:text-base">
                        <i className="fas fa-file-alt ml-2"></i>
                        دریافت گزارش پیشرفت ✨
                    </button>
                    {progressReport && (
                        <div className="card p-4 sm:p-6 rounded-xl shadow-md mt-4 sm:mt-6 text-left">
                            <h3 className="text-lg sm:text-xl font-bold mb-2 sm:mb-3 text-blue-700 dark:text-blue-300">نتیجه تحلیل:</h3>
                            <p className="text-gray-800 dark:text-gray-200 whitespace-pre-wrap text-sm sm:text-base">{progressReport}</p>
                        </div>
                    )}
                    <h3 className="text-xl sm:text-2xl font-bold text-gray-800 dark:text-gray-200 mb-3 sm:mb-4 mt-6 sm:mt-8">تاریخچه‌ی روزانه‌ی پاکی</h3>
                    <ul className="space-y-2 sm:space-y-3 max-h-48 sm:max-h-60 overflow-y-auto p-2 border border-gray-200 dark:border-gray-700 rounded-lg">
                        {dailyRecords.length === 0 && <li className="text-gray-600 dark:text-gray-400 text-sm sm:text-base">هنوز روزی ثبت نشده است.</li>}
                        {dailyRecords.map((record, index) => (
                            <li key={index} className="flex items-center justify-between bg-gray-50 dark:bg-gray-700 p-2 sm:p-3 rounded-md shadow-sm">
                                <span className="text-gray-800 dark:text-gray-200 text-xs sm:text-base">{formatDate(record)} - روز پاک</span>
                            </li>
                        ))}
                    </ul>
                </div>
            );
        }

        function NotificationSettingsScreen({ showSnackbar }) {
            const [dailyCheckInTime, setDailyCheckInTime] = useState(localStorage.getItem('notification_daily_check_in_time') || '09:00');
            const [motivationalMessageTime, setMotivationalMessageTime] = useState(localStorage.getItem('notification_motivational_message_time') || '12:00');
            const [isDailyCheckInEnabled, setIsDailyCheckInEnabled] = useState(localStorage.getItem('notification_daily_check_in_enabled') === 'true');
            const [isMotivationalMessageEnabled, setIsMotivationalMessageEnabled] = useState(localStorage.getItem('notification_motivational_message_enabled') === 'true');

            useEffect(() => {
                localStorage.setItem('notification_daily_check_in_time', dailyCheckInTime);
                localStorage.setItem('notification_motivational_message_time', motivationalMessageTime);
                localStorage.setItem('notification_daily_check_in_enabled', isDailyCheckInEnabled.toString());
                localStorage.setItem('notification_motivational_message_enabled', isMotivationalMessageEnabled.toString());
                
                if (isDailyCheckInEnabled || isMotivationalMessageEnabled) {
                    if ("Notification" in window && Notification.permission === "default") {
                        Notification.requestPermission().then(permission => {
                            if (permission === "granted") {
                                showSnackbar("نوتیفیکیشن‌ها فعال شدند.");
                            } else {
                                showSnackbar("اجازه نوتیفیکیشن داده نشد.");
                            }
                        });
                    }
                }
            }, [dailyCheckInTime, motivationalMessageTime, isDailyCheckInEnabled, isMotivationalMessageEnabled, showSnackbar]);

            return (
                <div className="text-center p-2">
                    <h2 className="text-2xl sm:text-3xl font-extrabold text-blue-700 dark:text-blue-300 mb-4 sm:mb-6">تنظیمات نوتیفیکیشن</h2>
                    <p className="text-xs sm:text-sm text-gray-600 dark:text-gray-400 mb-4 sm:mb-6">توجه: این نوتیفیکیشن‌ها فقط زمانی کار می‌کنند که اپلیکیشن در مرورگر باز باشد.</p>
                    <div className="card p-4 sm:p-6 rounded-xl shadow-md mb-4 sm:mb-6 text-left">
                        <div className="flex items-center justify-between mb-3 sm:mb-4">
                            <span className="text-lg sm:text-xl font-semibold text-gray-800 dark:text-gray-200">یادآور ثبت روزانه</span>
                            <label className="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" className="sr-only peer" checked={isDailyCheckInEnabled} onChange={(e) => setIsDailyCheckInEnabled(e.target.checked)} />
                                <div className="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border after:border-gray-300 after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"></div>
                            </label>
                        </div>
                        {isDailyCheckInEnabled && (
                            <div className="flex items-center mt-2">
                                <label htmlFor="daily-time" className="text-gray-700 dark:text-gray-300 ml-2 text-sm sm:text-base">ساعت:</label>
                                <input type="time" id="daily-time" value={dailyCheckInTime} onChange={(e) => setDailyCheckInTime(e.target.value)} className="p-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white text-sm sm:text-base" />
                            </div>
                        )}
                    </div>
                    <div className="card p-4 sm:p-6 rounded-xl shadow-md text-left">
                        <div className="flex items-center justify-between mb-3 sm:mb-4">
                            <span className="text-lg sm:text-xl font-semibold text-gray-800 dark:text-gray-200">یادآور پیام انگیزشی</span>
                            <label className="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" className="sr-only peer" checked={isMotivationalMessageEnabled} onChange={(e) => setIsMotivationalMessageEnabled(e.target.checked)} />
                                <div className="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border after:border-gray-300 after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"></div>
                            </label>
                        </div>
                        {isMotivationalMessageEnabled && (
                            <div className="flex items-center mt-2">
                                <label htmlFor="motivational-time" className="text-gray-700 dark:text-gray-300 ml-2 text-sm sm:text-base">ساعت:</label>
                                <input type="time" id="motivational-time" value={motivationalMessageTime} onChange={(e) => setMotivationalMessageTime(e.target.value)} className="p-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white text-sm sm:text-base" />
                            </div>
                        )}
                    </div>
                </div>
            );
        }
         function ChallengesScreen({ showSnackbar }) {
            const [challenge, setChallenge] = useState('');

            const generateChallenge = () => {
                if (challengeList.length > 0) {
                    const randomIndex = Math.floor(Math.random() * challengeList.length);
                    setChallenge(challengeList[randomIndex]);
                    showSnackbar('چالش با موفقیت تولید شد!');
                } else {
                    showSnackbar('متن‌های آماده برای تولید چالش موجود نیست.');
                }
            };
            return (
                <div className="text-center p-2">
                    <h2 className="text-2xl sm:text-3xl font-extrabold text-blue-700 dark:text-blue-300 mb-4 sm:mb-6">چالش روزانه</h2>
                    <div className="card p-4 sm:p-6 rounded-xl shadow-md mb-3 sm:mb-4 min-h-[80px] sm:min-h-[100px] flex items-center justify-center">
                        <p className="text-lg sm:text-xl font-semibold text-gray-800 dark:text-gray-200 leading-relaxed">
                            "{challenge || "برای دریافت چالش روزانه خود، دکمه زیر را فشار دهید."}"
                        </p>
                    </div>
                    <button onClick={generateChallenge} className="bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-full transition duration-300 ease-in-out transform hover:scale-105 mb-6 sm:mb-8 flex items-center justify-center mx-auto text-sm sm:text-base">
                        <i className="fas fa-dumbbell ml-2"></i>
                        دریافت چالش جدید ✨
                    </button>
                </div>
            );
        }

        function RecommendationsScreen({ showSnackbar }) {
            const [recommendation, setRecommendation] = useState('');

            const generateRecommendations = () => {
                if (recommendationsList.length > 0) {
                    const randomIndex = Math.floor(Math.random() * recommendationsList.length);
                    setRecommendation(recommendationsList[randomIndex]);
                    showSnackbar('توصیه‌ها با موفقیت دریافت شد!');
                } else {
                    showSnackbar('متن‌های آماده برای توصیه‌ها موجود نیست.');
                }
            };
            return (
                <div className="text-center p-2">
                    <h2 className="text-2xl sm:text-3xl font-extrabold text-blue-700 dark:text-blue-300 mb-4 sm:mb-6">توصیه‌ها</h2>
                    <button onClick={generateRecommendations} className="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-full transition duration-300 ease-in-out transform hover:scale-105 mb-6 sm:mb-8 flex items-center justify-center mx-auto text-sm sm:text-base">
                        <i className="fas fa-star ml-2"></i>
                        دریافت توصیه‌های جدید ✨
                    </button>
                    {recommendation && (
                        <div className="card p-4 sm:p-6 rounded-xl shadow-md mt-4 sm:mt-6 text-left whitespace-pre-wrap">
                            <h3 className="text-lg sm:text-xl font-bold mb-2 sm:mb-3 text-blue-700 dark:text-blue-300">توصیه‌هایی برای شما:</h3>
                            <div className="text-gray-800 dark:text-gray-200 text-sm sm:text-base space-y-1">{recommendation.split('\n').map((rec, i) => <p key={i}>{rec}</p>)}</div>
                        </div>
                    )}
                </div>
            );
        }

        function RewardsScreen({ showSnackbar, userName }) {
            const [rewardMessage, setRewardMessage] = useState('');
            const [cleanDaysForReward, setCleanDaysForReward] = useState(0);

            useEffect(() => {
                const storedCleanDays = localStorage.getItem('safemind_clean_days');
                if (storedCleanDays) setCleanDaysForReward(parseInt(storedCleanDays, 10));
            }, []);

            const generateRewardMessage = () => {
                const randomIndex = Math.floor(Math.random() * rewardMessages.length);
                let messageText = rewardMessages[randomIndex];
                messageText = messageText.replace('[نام کاربر]', userName || 'کاربر');
                setRewardMessage(messageText);
                showSnackbar('پیام پاداش با موفقیت تولید شد!');
            };
            return (
                <div className="text-center p-2">
                    <h2 className="text-2xl sm:text-3xl font-extrabold text-blue-700 dark:text-blue-300 mb-4 sm:mb-6">پاداش‌های شما</h2>
                    <p className="text-lg sm:text-xl text-gray-800 dark:text-gray-200 mb-3 sm:mb-4">شما تا کنون <span className="font-bold text-blue-600 dark:text-blue-400">{cleanDaysForReward}</span> روز پاک بوده‌اید!</p>
                    <button onClick={generateRewardMessage} className="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-full transition duration-300 ease-in-out transform hover:scale-105 mb-6 sm:mb-8 flex items-center justify-center mx-auto text-sm sm:text-base">
                        <i className="fas fa-trophy ml-2"></i>
                        دریافت پیام پاداش ✨
                    </button>
                    {rewardMessage && (
                        <div className="card p-4 sm:p-6 rounded-xl shadow-md mt-4 sm:mt-6 text-left">
                            <h3 className="text-lg sm:text-xl font-bold mb-2 sm:mb-3 text-blue-700 dark:text-blue-300">پیام تبریک:</h3>
                            <p className="text-gray-800 dark:text-gray-200 whitespace-pre-wrap text-sm sm:text-base">{rewardMessage}</p>
                        </div>
                    )}
                </div>
            );
        }

        function GoalSettingScreen({ showSnackbar }) {
            const [goalInput, setGoalInput] = useState('');
            const [goalPlan, setGoalPlan] = useState('');

            const generateGoalPlan = () => {
                if (!goalInput.trim()) {
                    showSnackbar('لطفاً هدف خود را وارد کنید.');
                    return;
                }
                const randomIndex = Math.floor(Math.random() * goalPlanSteps.length);
                setGoalPlan(goalPlanSteps[randomIndex]);
                showSnackbar('برنامه با موفقیت تولید شد!');
            };
            return (
                <div className="text-center p-2">
                    <h2 className="text-2xl sm:text-3xl font-extrabold text-blue-700 dark:text-blue-300 mb-4 sm:mb-6">برنامه‌ریزی هدف</h2>
                    <div className="mb-4 sm:mb-6 flex flex-col sm:flex-row gap-2 sm:gap-4">
                        <input type="text" className="flex-grow p-2 sm:p-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white text-sm sm:text-base" placeholder="هدف خود را وارد کنید (مثلاً: چگونه با استرس مقابله کنم؟)" value={goalInput} onChange={(e) => setGoalInput(e.target.value)} onKeyPress={(e) => { if (e.key === 'Enter') generateGoalPlan(); }} />
                        <button onClick={generateGoalPlan} disabled={!goalInput.trim()} className="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 sm:py-3 sm:px-6 rounded-lg transition duration-300 ease-in-out transform hover:scale-105 flex-shrink-0 text-sm sm:text-base">
                            <i className="fas fa-cogs ml-2"></i>
                            تولید برنامه ✨
                        </button>
                    </div>
                    {goalPlan && (
                        <div className="card p-4 sm:p-6 rounded-xl shadow-md mt-4 sm:mt-6 text-left whitespace-pre-wrap">
                            <h3 className="text-lg sm:text-xl font-bold mb-2 sm:mb-3 text-blue-700 dark:text-blue-300">برنامه‌ی شما:</h3>
                            <div className="text-gray-800 dark:text-gray-200 text-sm sm:text-base space-y-1">{goalPlan.split('\n').map((plan,i) => <p key={i}>{plan}</p>)}</div>
                        </div>
                    )}
                </div>
            );
        }

        function FocusGamesScreen({ showSnackbar }) {
            const icons = ['🍎', '🍌', '🍇', '🍓', '🍋', '🍐', '🥝', '🍊'];
            const initialCards = useRef([]);
            const [cards, setCards] = useState([]);
            const [flippedCards, setFlippedCards] = useState([]);
            const [matchedCards, setMatchedCards] = useState([]);
            const [canFlip, setCanFlip] = useState(true);

            useEffect(() => {
                initializeGame();
            }, []);

            const initializeGame = () => {
                const shuffledIcons = [...icons, ...icons].sort(() => 0.5 - Math.random());
                initialCards.current = shuffledIcons.map((icon, index) => ({
                    id: index,
                    icon: icon,
                    isFlipped: false,
                    isMatched: false,
                }));
                setCards(initialCards.current);
                setFlippedCards([]);
                setMatchedCards([]);
                setCanFlip(true);
            };

            const handleCardClick = (clickedCard) => {
                if (!canFlip || clickedCard.isFlipped || clickedCard.isMatched) return;

                const newCards = cards.map((card) =>
                    card.id === clickedCard.id ? { ...card, isFlipped: true } : card
                );
                setCards(newCards);
                setFlippedCards((prev) => [...prev, clickedCard]);
            };

            useEffect(() => {
                if (flippedCards.length === 2) {
                    setCanFlip(false);
                    const [card1, card2] = flippedCards;

                    if (card1.icon === card2.icon) {
                        setMatchedCards((prev) => [...prev, card1.id, card2.id]);
                        setFlippedCards([]);
                        setCanFlip(true);
                        showSnackbar('جفت پیدا شد! 🎉');
                    } else {
                        setTimeout(() => {
                            const resetCards = cards.map((card) =>
                                card.id === card1.id || card.id === card2.id
                                    ? { ...card, isFlipped: false }
                                    : card
                            );
                            setCards(resetCards);
                            setFlippedCards([]);
                            setCanFlip(true);
                            showSnackbar('متأسفانه جفت نشد. دوباره امتحان کن.');
                        }, 1000);
                    }
                }
            }, [flippedCards, cards, showSnackbar]);

            useEffect(() => {
                if (matchedCards.length === cards.length && cards.length > 0) {
                    showSnackbar('تبریک! بازی را بردی! 🥳');
                }
            }, [matchedCards, cards, showSnackbar]);

            return (
                <div className="text-center p-2">
                    <h2 className="text-2xl sm:text-3xl font-extrabold text-blue-700 dark:text-blue-300 mb-4 sm:mb-6">بازی حافظه</h2>
                    <p className="text-base sm:text-lg text-gray-700 dark:text-gray-300 mb-4">جفت کارت‌های مشابه را پیدا کن!</p>
                    <div className="memory-game-grid">
                        {cards.map((card) => (
                            <div
                                key={card.id}
                                className={`memory-card ${card.isFlipped || card.isMatched ? 'flipped' : ''} ${card.isMatched ? 'matched' : ''}`}
                                onClick={() => handleCardClick(card)}
                            >
                                <div className="card-face">
                                    {card.icon}
                                </div>
                                <div className="card-back">
                                    🧠
                                </div>
                            </div>
                        ))}
                    </div>
                    <button
                        onClick={initializeGame}
                        className="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-full transition duration-300 ease-in-out transform hover:scale-105 mt-6 text-base sm:text-lg"
                    >
                        شروع مجدد بازی
                    </button>
                </div>
            );
        }
        
        function App() {
            const [currentView, setCurrentView] = useState('splash'); 
            const { snackbarMessage, showSnackbar, show: showAppSnackbar } = useSnackbar();
            const [isSidebarOpen, setIsSidebarOpen] = useState(false);
            const [showRelapseConfirmModal, setShowRelapseConfirmModal] = useState(false);
            const [userName, setUserName] = useState(localStorage.getItem('safemind_user_name') || null);


            const [isDarkMode, setIsDarkMode] = useState(() => {
                const savedTheme = localStorage.getItem('safemind_theme');
                if (savedTheme) {
                    return savedTheme === 'dark';
                }
                return window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
            });

            useEffect(() => {
                if (isDarkMode) {
                    document.body.classList.add('dark');
                } else {
                    document.body.classList.remove('dark');
                }
                localStorage.setItem('safemind_theme', isDarkMode ? 'dark' : 'light');
            }, [isDarkMode]);

            const toggleTheme = () => {
                setIsDarkMode(prevMode => !prevMode);
            };


            const handleSplashFinish = () => {
                if (!userName) {
                    setCurrentView('userNamePrompt');
                } else {
                    setCurrentView('home');
                }
            };

            const handleSaveUserName = (name) => {
                setUserName(name);
                localStorage.setItem('safemind_user_name', name);
                setCurrentView('home');
            };

            const handleRelapseReset = () => {
                localStorage.removeItem('safemind_clean_days');
                localStorage.removeItem('safemind_last_check_in_date');
                localStorage.removeItem('safemind_daily_records');
                setShowRelapseConfirmModal(false);
                showAppSnackbar('روزهای پاک بازنشانی شد! لطفاً صفحه را رفرش کنید.');
                setTimeout(() => {
                    window.location.reload(true);
                }, 1500);
            };


            const renderScreen = () => {
                if (currentView === 'splash') {
                    return <SplashScreen onFinish={handleSplashFinish} />;
                }
                if (currentView === 'userNamePrompt') {
                    return <UserNamePrompt onSaveName={handleSaveUserName} />;
                }

                switch (currentView) {
                    case 'home':
                        return <HomeScreen showSnackbar={showAppSnackbar} userName={userName} />;
                    case 'messages':
                        return <MotivationalMessagesScreen showSnackbar={showAppSnackbar} />;
                    case 'reasons':
                        return <ReasonsWallScreen showSnackbar={showAppSnackbar} />;
                    case 'temptations':
                        return <TemptationStatsScreen showSnackbar={showAppSnackbar} />;
                    case 'profile':
                        return <ProfileScreen showSnackbar={showAppSnackbar} userName={userName} />;
                    case 'notifications':
                        return <NotificationSettingsScreen showSnackbar={showAppSnackbar} />;
                    case 'challenges':
                        return <ChallengesScreen showSnackbar={showAppSnackbar} />;
                    case 'recommendations':
                        return <RecommendationsScreen showSnackbar={showAppSnackbar} />;
                    case 'rewards':
                        return <RewardsScreen showSnackbar={showAppSnackbar} userName={userName} />;
                    case 'focusgames':
                        return <FocusGamesScreen showSnackbar={showAppSnackbar} />;
                    default:
                        return <HomeScreen showSnackbar={showAppSnackbar} userName={userName} />;
                }
            };

            const handleMenuItemClick = (view) => {
                setCurrentView(view);
                setIsSidebarOpen(false);
            };
            
            return (
                <div className="app-container"> 
                    {currentView === 'splash' && <SplashScreen onFinish={handleSplashFinish} />}
                    {currentView === 'userNamePrompt' && <UserNamePrompt onSaveName={handleSaveUserName} />}

                    {currentView !== 'splash' && currentView !== 'userNamePrompt' && (
                        <>
                            <div className="app-bar">
                                <button onClick={() => setIsSidebarOpen(prev => !prev)} className="text-white text-xl sm:text-2xl p-2 rounded-md hover:bg-blue-700 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-300 transition duration-200">
                                    <i className="fas fa-bars"></i>
                                </button>
                                <h1 className="text-xl sm:text-2xl font-bold">SafeMind</h1>
                                <button onClick={toggleTheme} className="text-white text-xl sm:text-2xl p-2 rounded-md hover:bg-blue-700 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-300 transition duration-200">
                                    <i className={`fas ${isDarkMode ? 'fa-sun' : 'fa-moon'}`}></i>
                                </button>
                            </div>

                            <div
                                className={`sidebar-overlay ${isSidebarOpen ? 'open' : ''}`}
                                onClick={() => setIsSidebarOpen(false)}
                            ></div>

                            <div className={`sidebar ${isSidebarOpen ? 'open' : ''}`}>
                                <button
                                    className="sidebar-button flex items-center justify-end text-red-500 hover:text-red-700 !border-b-2 !border-red-200 dark:!border-red-700"
                                    onClick={() => setIsSidebarOpen(false)}
                                >
                                    <i className="fas fa-times ml-2"></i>
                                    بستن
                                </button>
                                <button className={`sidebar-button ${currentView === 'home' ? 'active' : ''}`} onClick={() => handleMenuItemClick('home')}> <i className="fas fa-home"></i> <span>خانه</span> </button>
                                <button className={`sidebar-button ${currentView === 'recommendations' ? 'active' : ''}`} onClick={() => handleMenuItemClick('recommendations')}> <i className="fas fa-star"></i> <span>توصیه‌ها</span> </button>
                                <button className={`sidebar-button ${currentView === 'reasons' ? 'active' : ''}`} onClick={() => handleMenuItemClick('reasons')}> <i className="fas fa-lightbulb"></i> <span>دلایل</span> </button>
                                <button className={`sidebar-button ${currentView === 'messages' ? 'active' : ''}`} onClick={() => handleMenuItemClick('messages')}> <i className="fas fa-quote-right"></i> <span>پیام‌ها</span> </button>
                                <button className={`sidebar-button ${currentView === 'temptations' ? 'active' : ''}`} onClick={() => handleMenuItemClick('temptations')}> <i className="fas fa-chart-line"></i> <span>وسوسه‌ها</span> </button>
                                <button className={`sidebar-button ${currentView === 'profile' ? 'active' : ''}`} onClick={() => handleMenuItemClick('profile')}> <i className="fas fa-user-circle"></i> <span>پروفایل و تاریخچه</span> </button>
                                <button className={`sidebar-button ${currentView === 'rewards' ? 'active' : ''}`} onClick={() => handleMenuItemClick('rewards')}> <i className="fas fa-trophy"></i> <span>پاداش‌ها</span> </button>
                                <button className={`sidebar-button ${currentView === 'challenges' ? 'active' : ''}`} onClick={() => handleMenuItemClick('challenges')}> <i className="fas fa-dumbbell"></i> <span>چالش‌ها</span> </button>
                                <button className={`sidebar-button ${currentView === 'focusgames' ? 'active' : ''}`} onClick={() => handleMenuItemClick('focusgames')}> <i className="fas fa-gamepad"></i> <span>بازی‌های تمرکز</span> </button>
                                <button className={`sidebar-button ${currentView === 'notifications' ? 'active' : ''}`} onClick={() => handleMenuItemClick('notifications')}> <i className="fas fa-bell"></i> <span>نوتیفیکیشن‌ها</span> </button>
                                <button className="sidebar-button" onClick={() => { setIsSidebarOpen(false); setShowRelapseConfirmModal(true); }}> <i className="fas fa-redo-alt"></i> <span>بازنشانی روزهای پاک</span> </button>
                                <div className="mt-auto p-4 text-center text-gray-500 dark:text-gray-400 text-xs">
                                    SafeMind v1.4
                                    <br />
                                    Powered By BestMind
                                </div>
                            </div>

                            <div className="content-area">
                                {renderScreen()}
                            </div>

                            <Snackbar message={snackbarMessage} show={showSnackbar} />

                            {showRelapseConfirmModal && (
                                <RelapseConfirmationModal
                                    onConfirm={handleRelapseReset}
                                    onCancel={() => setShowRelapseConfirmModal(false)}
                                />
                            )}
                        </>
                    )}
                </div>
            );
        }

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>

</body>
</html>
